2023-06-05 22:32:40,869 - INFO  [main:CassandraDaemon@125] - Logging initialized
2023-06-05 22:32:40,879 - INFO  [main:CassandraDaemon@150] - JVM vendor/version: OpenJDK 64-Bit Server VM/1.8.0_292
2023-06-05 22:32:40,879 - WARN  [main:CassandraDaemon@155] - OpenJDK is not recommended. Please upgrade to the newest Oracle Java release
2023-06-05 22:32:40,879 - INFO  [main:CassandraDaemon@178] - Heap size: 8109490176/8109490176
2023-06-05 22:32:40,880 - INFO  [main:CassandraDaemon@179] - Classpath: /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/conf-1:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/build/classes/main:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/build/classes/thrift:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/antlr-3.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/commons-cli-1.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/commons-codec-1.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/commons-lang3-3.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/compress-lzf-0.8.4.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/concurrentlinkedhashmap-lru-1.3.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/disruptor-3.0.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/guava-15.0.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/high-scale-lib-1.1.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jackson-core-asl-1.9.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jackson-mapper-asl-1.9.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jamm-0.2.5.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jbcrypt-0.3m.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jline-1.0.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/json-simple-1.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/libthrift-0.9.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/log4j-1.2.16.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/lz4-1.2.0.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/metrics-core-2.2.0.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/netty-3.6.6.Final.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/reporter-config-2.1.0.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/servlet-api-2.5-20081211.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/slf4j-api-1.7.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/slf4j-log4j12-1.7.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/snakeyaml-1.11.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/snappy-java-1.0.5.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/snaptree-0.1.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/thrift-server-0.3.2.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/conf-1/*.jar:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/src-1/lib/jamm-0.2.5.jar
2023-06-05 22:32:40,881 - INFO  [main:CLibrary@63] - JNA not found. Native methods will be disabled.
2023-06-05 22:32:40,888 - INFO  [main:YamlConfigurationLoader@76] - Loading settings from file:/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/conf-1/cassandra.yaml
2023-06-05 22:32:41,079 - INFO  [main:DatabaseDescriptor@141] - Data files directories: [/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data]
2023-06-05 22:32:41,079 - INFO  [main:DatabaseDescriptor@142] - Commit log directory: /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/commitlog
2023-06-05 22:32:41,079 - INFO  [main:DatabaseDescriptor@182] - DiskAccessMode 'auto' determined to be mmap, indexAccessMode is mmap
2023-06-05 22:32:41,079 - INFO  [main:DatabaseDescriptor@196] - disk_failure_policy is best_effort
2023-06-05 22:32:41,082 - INFO  [main:DatabaseDescriptor@261] - Global memtable threshold is enabled at 1933MB
2023-06-05 22:32:41,157 - INFO  [main:DatabaseDescriptor@394] - Not using multi-threaded compaction
2023-06-05 22:32:41,312 - INFO  [main:CacheService@105] - Initializing key cache with capacity of 100 MBs.
2023-06-05 22:32:41,319 - INFO  [main:CacheService@117] - Scheduling key cache save to each 14400 seconds (going to save all keys).
2023-06-05 22:32:41,320 - INFO  [main:CacheService@131] - Initializing row cache with capacity of 0 MBs
2023-06-05 22:32:41,325 - INFO  [main:CacheService@141] - Scheduling row cache save to each 0 seconds (going to save all keys).
2023-06-05 22:32:41,375 - INFO  [main:ColumnFamilyStore@251] - Initializing system.sstable_activity
2023-06-05 22:32:41,391 - INFO  [main:ColumnFamilyStore@251] - Initializing system.hints
2023-06-05 22:32:41,393 - INFO  [main:ColumnFamilyStore@251] - Initializing system.NodeIdInfo
2023-06-05 22:32:41,396 - INFO  [main:ColumnFamilyStore@251] - Initializing system.compaction_history
2023-06-05 22:32:41,398 - INFO  [main:ColumnFamilyStore@251] - Initializing system.peers
2023-06-05 22:32:41,399 - INFO  [main:ColumnFamilyStore@251] - Initializing system.schema_columnfamilies
2023-06-05 22:32:41,401 - INFO  [main:ColumnFamilyStore@251] - Initializing system.IndexInfo
2023-06-05 22:32:41,403 - INFO  [main:ColumnFamilyStore@251] - Initializing system.local
2023-06-05 22:32:41,405 - INFO  [main:ColumnFamilyStore@251] - Initializing system.schema_triggers
2023-06-05 22:32:41,406 - INFO  [main:ColumnFamilyStore@251] - Initializing system.schema_columns
2023-06-05 22:32:41,408 - INFO  [main:ColumnFamilyStore@251] - Initializing system.batchlog
2023-06-05 22:32:41,410 - INFO  [main:ColumnFamilyStore@251] - Initializing system.peer_events
2023-06-05 22:32:41,412 - INFO  [main:ColumnFamilyStore@251] - Initializing system.paxos
2023-06-05 22:32:41,414 - INFO  [main:ColumnFamilyStore@251] - Initializing system.compactions_in_progress
2023-06-05 22:32:41,415 - INFO  [main:ColumnFamilyStore@251] - Initializing system.range_xfers
2023-06-05 22:32:41,417 - INFO  [main:ColumnFamilyStore@251] - Initializing system.schema_keyspaces
2023-06-05 22:32:41,582 - INFO  [main:DatabaseDescriptor@511] - Couldn't detect any schema definitions in local storage.
2023-06-05 22:32:41,583 - INFO  [main:DatabaseDescriptor@516] - To create keyspaces and column families, see 'help create' in cqlsh.
2023-06-05 22:32:41,616 - INFO  [main:ColumnFamilyStore@740] - Enqueuing flush of Memtable-local@1836463382(141/1410 serialized/live bytes, 6 ops)
2023-06-05 22:32:41,617 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-local@1836463382(141/1410 serialized/live bytes, 6 ops)
2023-06-05 22:32:41,668 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-1-Data.db (173 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=409)
2023-06-05 22:32:41,686 - INFO  [main:CommitLog@120] - No commitlog files found; skipping replay
2023-06-05 22:32:41,817 - INFO  [main:StorageService@480] - Cassandra version: 2.0.3-SNAPSHOT
2023-06-05 22:32:41,817 - INFO  [main:StorageService@481] - Thrift API version: 19.38.0
2023-06-05 22:32:41,820 - INFO  [main:StorageService@482] - CQL supported versions: 2.0.0,3.1.2 (default: 3.1.2)
2023-06-05 22:32:41,828 - INFO  [main:StorageService@505] - Loading persisted ring state
2023-06-05 22:32:41,880 - WARN  [main:SystemKeyspace@648] - No host ID found, created bef2f3c2-d63f-47a5-8185-9029a0b1e951 (Note: This should happen exactly once per node).
2023-06-05 22:32:41,883 - INFO  [main:StorageService@620] - Starting up server gossip
2023-06-05 22:32:41,892 - INFO  [main:ColumnFamilyStore@740] - Enqueuing flush of Memtable-local@330739404(329/3290 serialized/live bytes, 12 ops)
2023-06-05 22:32:41,892 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-local@330739404(329/3290 serialized/live bytes, 12 ops)
2023-06-05 22:32:41,945 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-2-Data.db (312 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=82231)
2023-06-05 22:32:41,978 - INFO  [main:MessagingService@474] - Starting Messaging Service on port 7000
2023-06-05 22:32:41,996 - INFO  [main:StorageService@752] - Saved tokens not found. Using configuration value: [-9223372036854775808]
2023-06-05 22:32:42,006 - INFO  [main:MigrationManager@220] - Create new Keyspace: system_traces, rep strategy:SimpleStrategy{org.apache.cassandra.config.CFMetaData@291b4bf5[cfId=c5e99f16-8677-3914-b17e-960613512345,ksName=system_traces,cfName=sessions,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.ColumnToCollectionType(706172616d6574657273:org.apache.cassandra.db.marshal.MapType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type))),comment=traced sessions,readRepairChance=0.0,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=0,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.UUIDType,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=73657373696f6e5f6964, validator=org.apache.cassandra.db.marshal.UUIDType, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=11 cap=11]=ColumnDefinition{name=636f6f7264696e61746f72, validator=org.apache.cassandra.db.marshal.InetAddressType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=7 cap=7]=ColumnDefinition{name=72657175657374, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=737461727465645f6174, validator=org.apache.cassandra.db.marshal.TimestampType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=706172616d6574657273, validator=org.apache.cassandra.db.marshal.MapType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type), type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6475726174696f6e, validator=org.apache.cassandra.db.marshal.Int32Type, type=REGULAR, componentIndex=0, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=3600000,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}], org.apache.cassandra.config.CFMetaData@6db9f5a4[cfId=8826e8e9-e16a-3728-8753-3bc1fc713c25,ksName=system_traces,cfName=events,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.TimeUUIDType,org.apache.cassandra.db.marshal.UTF8Type),comment=,readRepairChance=0.0,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=0,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.UUIDType,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6163746976697479, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=746872656164, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=73657373696f6e5f6964, validator=org.apache.cassandra.db.marshal.UUIDType, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6576656e745f6964, validator=org.apache.cassandra.db.marshal.TimeUUIDType, type=CLUSTERING_KEY, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=736f75726365, validator=org.apache.cassandra.db.marshal.InetAddressType, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=14 cap=14]=ColumnDefinition{name=736f757263655f656c6170736564, validator=org.apache.cassandra.db.marshal.Int32Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=3600000,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}]}, strategy_options: {replication_factor=2}, durable_writes: true
2023-06-05 22:32:42,144 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_keyspaces@995395310(251/2510 serialized/live bytes, 7 ops)
2023-06-05 22:32:42,144 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_keyspaces@995395310(251/2510 serialized/live bytes, 7 ops)
2023-06-05 22:32:42,177 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_keyspaces/system-schema_keyspaces-jb-1-Data.db (216 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=90966)
2023-06-05 22:32:42,178 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_columnfamilies@898854900(28865/288650 serialized/live bytes, 451 ops)
2023-06-05 22:32:42,178 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_columnfamilies@898854900(28865/288650 serialized/live bytes, 451 ops)
2023-06-05 22:32:42,211 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_columnfamilies/system-schema_columnfamilies-jb-1-Data.db (5724 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=90966)
2023-06-05 22:32:42,211 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_columns@833416606(51047/510470 serialized/live bytes, 848 ops)
2023-06-05 22:32:42,212 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_columns@833416606(51047/510470 serialized/live bytes, 848 ops)
2023-06-05 22:32:42,243 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_columns/system-schema_columns-jb-1-Data.db (10109 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=90966)
2023-06-05 22:32:42,282 - INFO  [MigrationStage:1:DefsTables@341] - Loading org.apache.cassandra.config.CFMetaData@42ec52c0[cfId=c5e99f16-8677-3914-b17e-960613512345,ksName=system_traces,cfName=sessions,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.ColumnToCollectionType(706172616d6574657273:org.apache.cassandra.db.marshal.MapType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type))),comment=traced sessions,readRepairChance=0.0,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=0,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.UUIDType,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=73657373696f6e5f6964, validator=org.apache.cassandra.db.marshal.UUIDType, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=11 cap=11]=ColumnDefinition{name=636f6f7264696e61746f72, validator=org.apache.cassandra.db.marshal.InetAddressType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=7 cap=7]=ColumnDefinition{name=72657175657374, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=737461727465645f6174, validator=org.apache.cassandra.db.marshal.TimestampType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6475726174696f6e, validator=org.apache.cassandra.db.marshal.Int32Type, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=706172616d6574657273, validator=org.apache.cassandra.db.marshal.MapType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type), type=REGULAR, componentIndex=0, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=3600000,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}]
2023-06-05 22:32:42,284 - INFO  [MigrationStage:1:ColumnFamilyStore@251] - Initializing system_traces.sessions
2023-06-05 22:32:42,286 - INFO  [MigrationStage:1:DefsTables@341] - Loading org.apache.cassandra.config.CFMetaData@13dd7858[cfId=8826e8e9-e16a-3728-8753-3bc1fc713c25,ksName=system_traces,cfName=events,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.TimeUUIDType,org.apache.cassandra.db.marshal.UTF8Type),comment=,readRepairChance=0.0,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=0,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.UUIDType,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6163746976697479, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]=ColumnDefinition{name=73657373696f6e5f6964, validator=org.apache.cassandra.db.marshal.UUIDType, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=746872656164, validator=org.apache.cassandra.db.marshal.UTF8Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=8 cap=8]=ColumnDefinition{name=6576656e745f6964, validator=org.apache.cassandra.db.marshal.TimeUUIDType, type=CLUSTERING_KEY, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=736f75726365, validator=org.apache.cassandra.db.marshal.InetAddressType, type=REGULAR, componentIndex=1, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=14 cap=14]=ColumnDefinition{name=736f757263655f656c6170736564, validator=org.apache.cassandra.db.marshal.Int32Type, type=REGULAR, componentIndex=1, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=3600000,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}]
2023-06-05 22:32:42,287 - INFO  [MigrationStage:1:ColumnFamilyStore@251] - Initializing system_traces.events
2023-06-05 22:32:42,305 - INFO  [main:ColumnFamilyStore@740] - Enqueuing flush of Memtable-local@2044366277(84/840 serialized/live bytes, 6 ops)
2023-06-05 22:32:42,305 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-local@2044366277(84/840 serialized/live bytes, 6 ops)
2023-06-05 22:32:42,335 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-3-Data.db (110 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=91225)
2023-06-05 22:32:42,339 - INFO  [main:ColumnFamilyStore@740] - Enqueuing flush of Memtable-local@1728579441(51/510 serialized/live bytes, 2 ops)
2023-06-05 22:32:42,339 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-local@1728579441(51/510 serialized/live bytes, 2 ops)
2023-06-05 22:32:42,376 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-4-Data.db (98 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=91392)
2023-06-05 22:32:42,383 - INFO  [CompactionExecutor:2:CompactionTask@115] - Compacting [SSTableReader(path='/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-1-Data.db'), SSTableReader(path='/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-4-Data.db'), SSTableReader(path='/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-3-Data.db'), SSTableReader(path='/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-2-Data.db')]
2023-06-05 22:32:42,393 - INFO  [main:StorageService@1371] - Node /127.0.0.1 state jump to normal
2023-06-05 22:32:42,397 - INFO  [main:StorageService@821] - Startup completed! Now serving reads.
2023-06-05 22:32:42,435 - INFO  [CompactionExecutor:2:CompactionTask@275] - Compacted 4 sstables to [/home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/local/system-local-jb-5,].  693 bytes to 530 (~76% of original) in 47ms = 0.010754MB/s.  4 total partitions merged to 1.  Partition merge counts were {4:1, }
2023-06-05 22:32:42,496 - INFO  [main:Server@156] - Starting listening for CQL clients on /127.0.0.1:9047...
2023-06-05 22:32:42,519 - INFO  [main:ThriftServer@99] - Using TFramedTransport with a max frame size of 15728640 bytes.
2023-06-05 22:32:42,520 - INFO  [main:ThriftServer$ThriftServerThread@118] - Binding thrift service to /127.0.0.1:9171
2023-06-05 22:32:42,523 - INFO  [main:TServerCustomFactory@47] - Using synchronous/threadpool thrift server on localhost : 9171
2023-06-05 22:32:42,524 - INFO  [Thread-2:ThriftServer$ThriftServerThread@135] - Listening for thrift clients...
2023-06-05 22:32:42,956 - INFO  [HANDSHAKE-/127.0.0.3:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.3
2023-06-05 22:32:42,968 - INFO  [HANDSHAKE-/127.0.0.2:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.2
2023-06-05 22:32:42,970 - INFO  [GossipStage:1:Gossiper@870] - Node /127.0.0.3 is now part of the cluster
2023-06-05 22:32:42,974 - INFO  [HANDSHAKE-/127.0.0.3:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.3
2023-06-05 22:32:42,978 - INFO  [GossipStage:1:Gossiper@870] - Node /127.0.0.2 is now part of the cluster
2023-06-05 22:32:42,979 - INFO  [HANDSHAKE-/127.0.0.2:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.2
2023-06-05 22:32:42,979 - INFO  [RequestResponseStage:1:Gossiper$2@833] - InetAddress /127.0.0.3 is now UP
2023-06-05 22:32:42,980 - INFO  [RequestResponseStage:2:Gossiper$2@833] - InetAddress /127.0.0.2 is now UP
2023-06-05 22:32:43,985 - INFO  [Native-Transport-Requests:40:MigrationManager@220] - Create new Keyspace: gray_space, rep strategy:SimpleStrategy{}, strategy_options: {replication_factor=3}, durable_writes: true
2023-06-05 22:32:43,986 - INFO  [HANDSHAKE-/127.0.0.2:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.2
2023-06-05 22:32:43,986 - INFO  [HANDSHAKE-/127.0.0.3:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.3
2023-06-05 22:32:43,989 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_keyspaces@100961345(138/1380 serialized/live bytes, 3 ops)
2023-06-05 22:32:43,989 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_keyspaces@100961345(138/1380 serialized/live bytes, 3 ops)
2023-06-05 22:32:44,018 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_keyspaces/system-schema_keyspaces-jb-2-Data.db (163 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=93872)
2023-06-05 22:32:45,070 - INFO  [Native-Transport-Requests:82:MigrationManager@234] - Create new ColumnFamily: org.apache.cassandra.config.CFMetaData@5e7d1174[cfId=7f032c76-8e13-34ff-8d56-24fa66dcb6ff,ksName=gray_space,cfName=gray_table,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type),comment=,readRepairChance=0.1,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=864000,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.Int32Type,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6437, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6434, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6432, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=7 cap=7]=ColumnDefinition{name=677261795f6964, validator=org.apache.cassandra.db.marshal.Int32Type, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6430, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6433, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6436, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6438, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6435, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6439, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6431, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=0,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}]
2023-06-05 22:32:45,075 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_columnfamilies@643740691(1422/14220 serialized/live bytes, 25 ops)
2023-06-05 22:32:45,076 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_columnfamilies@643740691(1422/14220 serialized/live bytes, 25 ops)
2023-06-05 22:32:45,105 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_columnfamilies/system-schema_columnfamilies-jb-2-Data.db (804 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=100447)
2023-06-05 22:32:45,106 - INFO  [MigrationStage:1:ColumnFamilyStore@740] - Enqueuing flush of Memtable-schema_columns@1244541903(3929/39290 serialized/live bytes, 77 ops)
2023-06-05 22:32:45,106 - INFO  [FlushWriter:1:Memtable$FlushRunnable@333] - Writing Memtable-schema_columns@1244541903(3929/39290 serialized/live bytes, 77 ops)
2023-06-05 22:32:45,138 - INFO  [FlushWriter:1:Memtable$FlushRunnable@373] - Completed flushing /home/tonypan/flaky-reproduction/experiment/cassandra-6415/cluster/store-1/data/system/schema_columns/system-schema_columns-jb-2-Data.db (700 bytes) for commitlog position ReplayPosition(segmentId=1686018761568, position=100447)
2023-06-05 22:32:45,146 - INFO  [MigrationStage:1:DefsTables@341] - Loading org.apache.cassandra.config.CFMetaData@43a0b9c8[cfId=7f032c76-8e13-34ff-8d56-24fa66dcb6ff,ksName=gray_space,cfName=gray_table,cfType=Standard,comparator=org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type),comment=,readRepairChance=0.1,dclocalReadRepairChance=0.0,replicateOnWrite=true,gcGraceSeconds=864000,defaultValidator=org.apache.cassandra.db.marshal.BytesType,keyValidator=org.apache.cassandra.db.marshal.Int32Type,minCompactionThreshold=4,maxCompactionThreshold=32,column_metadata={java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6437, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6434, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6432, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=7 cap=7]=ColumnDefinition{name=677261795f6964, validator=org.apache.cassandra.db.marshal.Int32Type, type=PARTITION_KEY, componentIndex=null, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6430, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6433, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6436, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6438, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6435, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6439, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}, java.nio.HeapByteBuffer[pos=0 lim=6 cap=6]=ColumnDefinition{name=6669656c6431, validator=org.apache.cassandra.db.marshal.AsciiType, type=REGULAR, componentIndex=0, indexName=null, indexType=null}},compactionStrategyClass=class org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy,compactionStrategyOptions={},compressionOptions={sstable_compression=org.apache.cassandra.io.compress.LZ4Compressor},bloomFilterFpChance=0.01,memtable_flush_period_in_ms=0,caching=KEYS_ONLY,defaultTimeToLive=0,speculative_retry=99.0PERCENTILE,indexInterval=128,populateIoCacheOnFlush=false,droppedColumns={},triggers={}]
2023-06-05 22:32:45,147 - INFO  [MigrationStage:1:ColumnFamilyStore@251] - Initializing gray_space.gray_table
2023-06-05 22:32:46,009 - WARN  [Native-Transport-Requests:107:FBUtilities@361] - Trigger directory doesn't exist, please create it and try again.
2023-06-05 22:32:48,089 - INFO  [HANDSHAKE-/127.0.0.1:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.1
2023-06-05 22:32:48,097 - INFO  [HANDSHAKE-/127.0.0.1:OutboundTcpConnection$1@386] - Handshaking version with /127.0.0.1
2023-06-05 22:32:48,322 - INFO  [MemoryMeter:1:Memtable$MeteringRunnable@451] - CFS(Keyspace='gray_space', ColumnFamily='gray_table') liveRatio is 6.163662755534051 (just-counted was 2.327325511068102).  calculation took 28ms for 77 cells
2023-06-05 22:32:48,414 - INFO  [MemoryMeter:1:Memtable$MeteringRunnable@451] - CFS(Keyspace='gray_space', ColumnFamily='gray_table') liveRatio is 4.230010886657796 (just-counted was 2.296359017781541).  calculation took 17ms for 77 cells
2023-06-05 22:32:48,586 - INFO  [MemoryMeter:1:Memtable$MeteringRunnable@451] - CFS(Keyspace='gray_space', ColumnFamily='gray_table') liveRatio is 3.2670557638804887 (just-counted was 2.3041006411031812).  calculation took 15ms for 77 cells
2023-06-05 22:33:25,807 - INFO  [Thread-12:StorageService$4@2324] - Starting repair command #1, repairing 3 ranges for keyspace gray_space
2023-06-05 22:33:25,811 - INFO  [AntiEntropySessions:1:RepairSession@236] - [repair #838de120-0412-11ee-975d-ed7ba4a7ec65] new session: will sync /127.0.0.1, /127.0.0.2, /127.0.0.3 on range (3074457345618258602,-9223372036854775808] for gray_space.[gray_table]
2023-06-05 22:33:47,978 - INFO  [GossipTasks:1:Gossiper@850] - InetAddress /127.0.0.3 is now DOWN
2023-06-05 22:33:47,979 - INFO  [AntiEntropySessions:2:RepairSession@236] - [repair #90c499b0-0412-11ee-975d-ed7ba4a7ec65] new session: will sync /127.0.0.1, /127.0.0.2, /127.0.0.3 on range (-9223372036854775808,-3074457345618258603] for gray_space.[gray_table]
2023-06-05 22:33:47,980 - ERROR [AntiEntropySessions:2:RepairSession@252] - [repair #90c499b0-0412-11ee-975d-ed7ba4a7ec65] Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
2023-06-05 22:33:47,980 - INFO  [AntiEntropySessions:3:RepairSession@236] - [repair #90c4c0c0-0412-11ee-975d-ed7ba4a7ec65] new session: will sync /127.0.0.1, /127.0.0.2, /127.0.0.3 on range (-3074457345618258603,3074457345618258602] for gray_space.[gray_table]
2023-06-05 22:33:47,980 - ERROR [AntiEntropySessions:3:RepairSession@252] - [repair #90c4c0c0-0412-11ee-975d-ed7ba4a7ec65] Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
2023-06-05 22:33:47,981 - ERROR [AntiEntropySessions:3:CassandraDaemon$2@187] - Exception in thread Thread[AntiEntropySessions:3,5,RMI Runtime]
java.lang.RuntimeException: java.io.IOException: Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
	at com.google.common.base.Throwables.propagate(Throwables.java:160)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
	at org.apache.cassandra.repair.RepairSession.runMayThrow(RepairSession.java:253)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	... 5 more
2023-06-05 22:33:47,981 - ERROR [AntiEntropySessions:2:CassandraDaemon$2@187] - Exception in thread Thread[AntiEntropySessions:2,5,RMI Runtime]
java.lang.RuntimeException: java.io.IOException: Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
	at com.google.common.base.Throwables.propagate(Throwables.java:160)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Cannot proceed on repair because a neighbor (/127.0.0.3) is dead: session failed
	at org.apache.cassandra.repair.RepairSession.runMayThrow(RepairSession.java:253)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	... 5 more
