JUnit version 4.13.2
2023-07-02 17:26:36,591 - INFO  [main:MiniKdc@225] - Configuration:
2023-07-02 17:26:36,595 - INFO  [main:MiniKdc@226] - ---------------------------------------------------------------
2023-07-02 17:26:36,598 - INFO  [main:MiniKdc@228] -   debug: false
2023-07-02 17:26:36,598 - INFO  [main:MiniKdc@228] -   transport: TCP
2023-07-02 17:26:36,599 - INFO  [main:MiniKdc@228] -   max.ticket.lifetime: 86400000
2023-07-02 17:26:36,599 - INFO  [main:MiniKdc@228] -   org.name: EXAMPLE
2023-07-02 17:26:36,599 - INFO  [main:MiniKdc@228] -   kdc.port: 0
2023-07-02 17:26:36,599 - INFO  [main:MiniKdc@228] -   org.domain: COM
2023-07-02 17:26:36,599 - INFO  [main:MiniKdc@228] -   max.renewable.lifetime: 604800000
2023-07-02 17:26:36,600 - INFO  [main:MiniKdc@228] -   instance: DefaultKrbServer
2023-07-02 17:26:36,600 - INFO  [main:MiniKdc@228] -   kdc.bind.address: localhost
2023-07-02 17:26:36,600 - INFO  [main:MiniKdc@230] - ---------------------------------------------------------------
2023-07-02 17:26:36,750 - INFO  [main:MiniKdc@285] - MiniKdc started.
.2023-07-02 17:26:38,035 - INFO  [Time-limited test:MiniDFSCluster@554] - starting cluster: numNameNodes=1, numDataNodes=1
2023-07-02 17:26:38,332 - WARN  [Time-limited test:NativeCodeLoader@60] - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2023-07-02 17:26:38,444 - INFO  [Time-limited test:NameNode@1248] - Formatting using clusterid: testClusterID
2023-07-02 17:26:38,460 - INFO  [Time-limited test:FSEditLog@234] - Edit logging is async:true
2023-07-02 17:26:38,485 - INFO  [Time-limited test:FSNamesystem@859] - KeyProvider: null
2023-07-02 17:26:38,487 - INFO  [Time-limited test:FSNamesystemLock@142] - fsLock is fair: true
2023-07-02 17:26:38,488 - INFO  [Time-limited test:FSNamesystemLock@160] - Detailed lock hold time metrics enabled: false
2023-07-02 17:26:38,493 - INFO  [Time-limited test:FSNamesystem@898] - fsOwner                = tonypan (auth:SIMPLE)
2023-07-02 17:26:38,493 - INFO  [Time-limited test:FSNamesystem@899] - supergroup             = supergroup
2023-07-02 17:26:38,493 - INFO  [Time-limited test:FSNamesystem@900] - isPermissionEnabled    = true
2023-07-02 17:26:38,493 - INFO  [Time-limited test:FSNamesystem@901] - isStoragePolicyEnabled = true
2023-07-02 17:26:38,494 - INFO  [Time-limited test:FSNamesystem@912] - HA Enabled: false
2023-07-02 17:26:38,593 - INFO  [Time-limited test:Util@428] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2023-07-02 17:26:38,598 - INFO  [Time-limited test:Configuration@1441] - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2023-07-02 17:26:38,598 - INFO  [Time-limited test:DatanodeManager@325] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2023-07-02 17:26:38,598 - INFO  [Time-limited test:DatanodeManager@332] - dfs.namenode.datanode.registration.ip-hostname-check=true
2023-07-02 17:26:38,601 - INFO  [Time-limited test:InvalidateBlocks@77] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2023-07-02 17:26:38,602 - INFO  [Time-limited test:InvalidateBlocks@83] - The block deletion will start around 2023 Jul 02 17:26:38
2023-07-02 17:26:38,603 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map BlocksMap
2023-07-02 17:26:38,603 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:38,605 - INFO  [Time-limited test:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2023-07-02 17:26:38,605 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2023-07-02 17:26:38,685 - INFO  [Time-limited test:BlockManager@5343] - Storage policy satisfier is disabled
2023-07-02 17:26:38,685 - INFO  [Time-limited test:BlockManager@618] - dfs.block.access.token.enable = true
2023-07-02 17:26:38,685 - INFO  [Time-limited test:BlockManager@640] - dfs.block.access.key.update.interval=600 min(s), dfs.block.access.token.lifetime=600 min(s), dfs.encrypt.data.transfer.algorithm=null
2023-07-02 17:26:38,692 - INFO  [Time-limited test:BlockTokenSecretManager@155] - Block token key range: [0, 2147483647)
2023-07-02 17:26:38,698 - INFO  [Time-limited test:BlockManagerSafeMode$SafeModeMonitor@656] - Using 1000 as SafeModeMonitor Interval
2023-07-02 17:26:38,698 - INFO  [Time-limited test:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.999
2023-07-02 17:26:38,698 - INFO  [Time-limited test:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2023-07-02 17:26:38,698 - INFO  [Time-limited test:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2023-07-02 17:26:38,699 - INFO  [Time-limited test:BlockManager@604] - defaultReplication         = 1
2023-07-02 17:26:38,699 - INFO  [Time-limited test:BlockManager@605] - maxReplication             = 512
2023-07-02 17:26:38,699 - INFO  [Time-limited test:BlockManager@606] - minReplication             = 1
2023-07-02 17:26:38,699 - INFO  [Time-limited test:BlockManager@607] - maxReplicationStreams      = 2
2023-07-02 17:26:38,700 - INFO  [Time-limited test:BlockManager@608] - redundancyRecheckInterval  = 3000ms
2023-07-02 17:26:38,700 - INFO  [Time-limited test:BlockManager@609] - encryptDataTransfer        = false
2023-07-02 17:26:38,700 - INFO  [Time-limited test:BlockManager@610] - maxNumBlocksToLog          = 1000
2023-07-02 17:26:38,721 - INFO  [Time-limited test:SerialNumberManager@51] - GLOBAL serial map: bits=29 maxEntries=536870911
2023-07-02 17:26:38,721 - INFO  [Time-limited test:SerialNumberManager@51] - USER serial map: bits=24 maxEntries=16777215
2023-07-02 17:26:38,721 - INFO  [Time-limited test:SerialNumberManager@51] - GROUP serial map: bits=24 maxEntries=16777215
2023-07-02 17:26:38,721 - INFO  [Time-limited test:SerialNumberManager@51] - XATTR serial map: bits=24 maxEntries=16777215
2023-07-02 17:26:38,732 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map INodeMap
2023-07-02 17:26:38,732 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:38,732 - INFO  [Time-limited test:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2023-07-02 17:26:38,732 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2023-07-02 17:26:38,770 - INFO  [Time-limited test:FSDirectory@335] - ACLs enabled? true
2023-07-02 17:26:38,771 - INFO  [Time-limited test:FSDirectory@339] - POSIX ACL inheritance enabled? true
2023-07-02 17:26:38,771 - INFO  [Time-limited test:FSDirectory@343] - XAttrs enabled? true
2023-07-02 17:26:38,771 - INFO  [Time-limited test:FSDirectory@406] - Caching file names occurring more than 10 times
2023-07-02 17:26:38,776 - INFO  [Time-limited test:SnapshotManager@163] - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotFSLimit: 65536, maxSnapshotLimit: 65536
2023-07-02 17:26:38,776 - INFO  [Time-limited test:SnapshotManager@176] - dfs.namenode.snapshot.deletion.ordered = false
2023-07-02 17:26:38,779 - INFO  [Time-limited test:DirectoryDiffListFactory@43] - SkipList is disabled
2023-07-02 17:26:38,783 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2023-07-02 17:26:38,783 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:38,783 - INFO  [Time-limited test:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2023-07-02 17:26:38,783 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2023-07-02 17:26:38,799 - INFO  [Time-limited test:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2023-07-02 17:26:38,799 - INFO  [Time-limited test:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2023-07-02 17:26:38,799 - INFO  [Time-limited test:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2023-07-02 17:26:38,803 - INFO  [Time-limited test:FSNamesystem@1142] - Retry cache on namenode is enabled
2023-07-02 17:26:38,803 - INFO  [Time-limited test:FSNamesystem@1150] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2023-07-02 17:26:38,805 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2023-07-02 17:26:38,805 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:38,805 - INFO  [Time-limited test:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2023-07-02 17:26:38,805 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2023-07-02 17:26:38,830 - INFO  [Time-limited test:FSImage@186] - Allocated new BlockPoolId: BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:38,894 - INFO  [Time-limited test:NNStorage@595] - Storage directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1 has been successfully formatted.
2023-07-02 17:26:38,945 - INFO  [Time-limited test:NNStorage@595] - Storage directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2 has been successfully formatted.
2023-07-02 17:26:38,989 - INFO  [FSImageSaver for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@732] - Saving image file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 using no compression
2023-07-02 17:26:38,989 - INFO  [FSImageSaver for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@732] - Saving image file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 using no compression
2023-07-02 17:26:39,192 - INFO  [FSImageSaver for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@736] - Image file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 of size 402 bytes saved in 0 seconds .
2023-07-02 17:26:39,192 - INFO  [FSImageSaver for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@736] - Image file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 of size 402 bytes saved in 0 seconds .
2023-07-02 17:26:39,246 - INFO  [Time-limited test:NNStorageRetentionManager@202] - Going to retain 1 images with txid >= 0
2023-07-02 17:26:39,334 - INFO  [Time-limited test:FSNamesystem@1493] - Stopping services started for active state
2023-07-02 17:26:39,335 - INFO  [Time-limited test:FSNamesystem@1597] - Stopping services started for standby state
2023-07-02 17:26:39,336 - INFO  [Time-limited test:NameNode@1706] - createNameNode []
2023-07-02 17:26:39,482 - INFO  [Time-limited test:MetricsConfig@120] - Loaded properties from hadoop-metrics2.properties
2023-07-02 17:26:39,539 - INFO  [Time-limited test:MetricsSystemImpl@378] - Scheduled Metric snapshot period at 0 second(s).
2023-07-02 17:26:39,539 - INFO  [Time-limited test:MetricsSystemImpl@191] - NameNode metrics system started
2023-07-02 17:26:39,544 - INFO  [Time-limited test:NameNodeUtils@79] - fs.defaultFS is hdfs://127.0.0.1:0
2023-07-02 17:26:39,608 - INFO  [pool-1-thread-1:KdcRequest@651] - The preauth data is empty.
2023-07-02 17:26:39,615 - INFO  [pool-1-thread-1:KdcHandler@177] - KRB error occurred while processing request:Additional pre-authentication required
2023-07-02 17:26:39,674 - INFO  [pool-1-thread-1:AsRequest@112] - AS_REQ ISSUE: authtime 1688333199672,hdfs/localhost@EXAMPLE.COM for krbtgt/EXAMPLE.COM@EXAMPLE.COM
2023-07-02 17:26:39,683 - INFO  [Time-limited test:UserGroupInformation@1128] - Login successful for user hdfs/localhost@EXAMPLE.COM using keytab file hdfs.keytab. Keytab auto renewal enabled : false
2023-07-02 17:26:39,725 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@7781d137:JvmPauseMonitor$Monitor@185] - Starting JVM pause monitor
2023-07-02 17:26:39,743 - INFO  [Time-limited test:DFSUtil@1736] - Filter initializers set : org.apache.hadoop.http.lib.StaticUserWebFilter,org.apache.hadoop.hdfs.web.AuthFilterInitializer
2023-07-02 17:26:39,750 - INFO  [Time-limited test:DFSUtil@1746] - Starting web server as: HTTP/localhost@EXAMPLE.COM
2023-07-02 17:26:39,751 - INFO  [Time-limited test:DFSUtil@1771] - Starting Web-server for hdfs at: https://localhost:0
2023-07-02 17:26:39,772 - INFO  [Time-limited test:Log@170] - Logging initialized @3869ms to org.eclipse.jetty.util.log.Slf4jLog
2023-07-02 17:26:39,920 - WARN  [Time-limited test:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets. Reason: Could not read signature secret file: /home/tonypan/hadoop-http-auth-signature-secret
2023-07-02 17:26:39,925 - INFO  [Time-limited test:HttpRequestLog@82] - Http request log for http.requests.namenode is not defined
2023-07-02 17:26:39,935 - INFO  [Time-limited test:HttpServer2@1155] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2023-07-02 17:26:39,937 - INFO  [Time-limited test:HttpServer2@1128] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2023-07-02 17:26:39,937 - INFO  [Time-limited test:HttpServer2@1138] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2023-07-02 17:26:39,940 - INFO  [Time-limited test:HttpServer2@1128] - Added filter AuthFilter (class=org.apache.hadoop.hdfs.web.AuthFilter) to context hdfs
2023-07-02 17:26:39,940 - INFO  [Time-limited test:HttpServer2@1138] - Added filter AuthFilter (class=org.apache.hadoop.hdfs.web.AuthFilter) to context static
2023-07-02 17:26:39,991 - INFO  [Time-limited test:HttpServer2@982] - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2023-07-02 17:26:40,000 - INFO  [Time-limited test:HttpServer2@1386] - Jetty bound to port 45635
2023-07-02 17:26:40,001 - INFO  [Time-limited test:Server@375] - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_275-8u275-b01-0ubuntu1~18.04-b01
2023-07-02 17:26:40,036 - INFO  [Time-limited test:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2023-07-02 17:26:40,036 - INFO  [Time-limited test:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2023-07-02 17:26:40,038 - INFO  [Time-limited test:HouseKeeper@132] - node0 Scavenging every 600000ms
2023-07-02 17:26:40,058 - WARN  [Time-limited test:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets. Reason: Could not read signature secret file: /home/tonypan/hadoop-http-auth-signature-secret
2023-07-02 17:26:40,060 - INFO  [Time-limited test:ContextHandler@915] - Started o.e.j.s.ServletContextHandler@5ed67d97{static,/static,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/static/,AVAILABLE}
2023-07-02 17:26:40,131 - INFO  [Time-limited test:ContextHandler@915] - Started o.e.j.w.WebAppContext@3ae86952{hdfs,/,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/hdfs/,AVAILABLE}{file:/home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/hdfs}
2023-07-02 17:26:40,154 - INFO  [Time-limited test:SslContextFactory@358] - x509=X509@5b75d4fe(server,h=[localhost],a=[],w=[]) for Server@117a5778[provider=null,keyStore=file:///home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/SaslDataTransferTestCase/serverKS.jks,trustStore=file:///home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/SaslDataTransferTestCase/trustKS.jks]
2023-07-02 17:26:40,164 - INFO  [Time-limited test:AbstractConnector@331] - Started ServerConnector@6723e217{SSL, (ssl, http/1.1)}{localhost:45635}
2023-07-02 17:26:40,165 - INFO  [Time-limited test:Server@415] - Started @4263ms
2023-07-02 17:26:40,175 - INFO  [Time-limited test:FSEditLog@234] - Edit logging is async:true
2023-07-02 17:26:40,189 - INFO  [Time-limited test:FSNamesystem@859] - KeyProvider: null
2023-07-02 17:26:40,189 - INFO  [Time-limited test:FSNamesystemLock@142] - fsLock is fair: true
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystemLock@160] - Detailed lock hold time metrics enabled: false
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystem@898] - fsOwner                = hdfs/localhost@EXAMPLE.COM (auth:KERBEROS)
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystem@899] - supergroup             = supergroup
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystem@900] - isPermissionEnabled    = true
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystem@901] - isStoragePolicyEnabled = true
2023-07-02 17:26:40,190 - INFO  [Time-limited test:FSNamesystem@912] - HA Enabled: false
2023-07-02 17:26:40,191 - INFO  [Time-limited test:Util@428] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2023-07-02 17:26:40,191 - INFO  [Time-limited test:DatanodeManager@325] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2023-07-02 17:26:40,191 - INFO  [Time-limited test:DatanodeManager@332] - dfs.namenode.datanode.registration.ip-hostname-check=true
2023-07-02 17:26:40,192 - INFO  [Time-limited test:InvalidateBlocks@77] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2023-07-02 17:26:40,192 - INFO  [Time-limited test:InvalidateBlocks@83] - The block deletion will start around 2023 Jul 02 17:26:40
2023-07-02 17:26:40,193 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map BlocksMap
2023-07-02 17:26:40,193 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:40,193 - INFO  [Time-limited test:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2023-07-02 17:26:40,193 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2023-07-02 17:26:40,481 - INFO  [Time-limited test:BlockManager@5343] - Storage policy satisfier is disabled
2023-07-02 17:26:40,481 - INFO  [Time-limited test:BlockManager@618] - dfs.block.access.token.enable = true
2023-07-02 17:26:40,482 - INFO  [Time-limited test:BlockManager@640] - dfs.block.access.key.update.interval=600 min(s), dfs.block.access.token.lifetime=600 min(s), dfs.encrypt.data.transfer.algorithm=null
2023-07-02 17:26:40,482 - INFO  [Time-limited test:BlockTokenSecretManager@155] - Block token key range: [0, 2147483647)
2023-07-02 17:26:40,482 - INFO  [Time-limited test:BlockManagerSafeMode$SafeModeMonitor@656] - Using 1000 as SafeModeMonitor Interval
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.999
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@604] - defaultReplication         = 1
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@605] - maxReplication             = 512
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@606] - minReplication             = 1
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@607] - maxReplicationStreams      = 2
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@608] - redundancyRecheckInterval  = 3000ms
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@609] - encryptDataTransfer        = false
2023-07-02 17:26:40,483 - INFO  [Time-limited test:BlockManager@610] - maxNumBlocksToLog          = 1000
2023-07-02 17:26:40,484 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map INodeMap
2023-07-02 17:26:40,484 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:40,484 - INFO  [Time-limited test:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2023-07-02 17:26:40,484 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2023-07-02 17:26:40,503 - INFO  [Time-limited test:FSDirectory@335] - ACLs enabled? true
2023-07-02 17:26:40,505 - INFO  [Time-limited test:FSDirectory@339] - POSIX ACL inheritance enabled? true
2023-07-02 17:26:40,505 - INFO  [Time-limited test:FSDirectory@343] - XAttrs enabled? true
2023-07-02 17:26:40,506 - INFO  [Time-limited test:FSDirectory@406] - Caching file names occurring more than 10 times
2023-07-02 17:26:40,506 - INFO  [Time-limited test:SnapshotManager@163] - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotFSLimit: 65536, maxSnapshotLimit: 65536
2023-07-02 17:26:40,506 - INFO  [Time-limited test:SnapshotManager@176] - dfs.namenode.snapshot.deletion.ordered = false
2023-07-02 17:26:40,506 - INFO  [Time-limited test:DirectoryDiffListFactory@43] - SkipList is disabled
2023-07-02 17:26:40,506 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2023-07-02 17:26:40,506 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:40,506 - INFO  [Time-limited test:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2023-07-02 17:26:40,507 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2023-07-02 17:26:40,516 - INFO  [Time-limited test:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2023-07-02 17:26:40,516 - INFO  [Time-limited test:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2023-07-02 17:26:40,516 - INFO  [Time-limited test:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2023-07-02 17:26:40,516 - INFO  [Time-limited test:FSNamesystem@1142] - Retry cache on namenode is enabled
2023-07-02 17:26:40,516 - INFO  [Time-limited test:FSNamesystem@1150] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2023-07-02 17:26:40,517 - INFO  [Time-limited test:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2023-07-02 17:26:40,517 - INFO  [Time-limited test:LightWeightGSet@396] - VM type       = 64-bit
2023-07-02 17:26:40,517 - INFO  [Time-limited test:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2023-07-02 17:26:40,517 - INFO  [Time-limited test:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2023-07-02 17:26:40,545 - INFO  [Time-limited test:Storage$StorageDirectory@948] - Lock on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 32519@razor7
2023-07-02 17:26:40,570 - INFO  [Time-limited test:Storage$StorageDirectory@948] - Lock on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 32519@razor7
2023-07-02 17:26:40,573 - INFO  [Time-limited test:FileJournalManager@428] - Recovering unfinalized segments in /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current
2023-07-02 17:26:40,573 - INFO  [Time-limited test:FileJournalManager@428] - Recovering unfinalized segments in /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/current
2023-07-02 17:26:40,574 - INFO  [Time-limited test:FSImage@734] - No edit log streams selected.
2023-07-02 17:26:40,574 - INFO  [Time-limited test:FSImage@800] - Planning to load image: FSImageFile(file=/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2023-07-02 17:26:40,599 - INFO  [Time-limited test:FSImageFormatPBINode$Loader@413] - Loading 1 INodes.
2023-07-02 17:26:40,600 - INFO  [Time-limited test:FSImageFormatPBINode$Loader@371] - Successfully loaded 1 inodes
2023-07-02 17:26:40,603 - INFO  [Time-limited test:FSImageFormatPBINode$Loader@344] - Completed update blocks map and name cache, total waiting duration 0ms.
2023-07-02 17:26:40,605 - INFO  [Time-limited test:FSImageFormatProtobuf$Loader@255] - Loaded FSImage in 0 seconds.
2023-07-02 17:26:40,605 - INFO  [Time-limited test:FSImage@978] - Loaded image for txid 0 from /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2023-07-02 17:26:40,608 - INFO  [Time-limited test:FSNamesystem@1264] - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2023-07-02 17:26:40,608 - INFO  [Time-limited test:FSEditLog@1410] - Starting log segment at 1
2023-07-02 17:26:40,840 - INFO  [Time-limited test:NameCache@143] - initialized with 0 entries 0 lookups
2023-07-02 17:26:40,841 - INFO  [Time-limited test:FSNamesystem@831] - Finished loading FSImage in 321 msecs
2023-07-02 17:26:41,869 - INFO  [Time-limited test:NameNodeRpcServer@444] - RPC server is binding to localhost:0
2023-07-02 17:26:41,869 - INFO  [Time-limited test:NameNodeRpcServer@449] - Enable NameNode state context:false
2023-07-02 17:26:41,878 - INFO  [Time-limited test:CallQueueManager@93] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2023-07-02 17:26:41,888 - INFO  [Socket Reader #1 for port 0:Server$Listener$Reader@1392] - Starting Socket Reader #1 for port 0
2023-07-02 17:26:42,095 - INFO  [Listener at localhost/35255:NameNode@775] - Clients are to use localhost:35255 to access this namenode/service.
2023-07-02 17:26:42,098 - INFO  [Listener at localhost/35255:FSNamesystem@5584] - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2023-07-02 17:26:42,132 - INFO  [Listener at localhost/35255:LeaseManager@166] - Number of blocks under construction: 0
2023-07-02 17:26:42,140 - INFO  [Listener at localhost/35255:DatanodeAdminDefaultMonitor@116] - Initialized the Default Decommission and Maintenance monitor
2023-07-02 17:26:42,142 - INFO  [org.apache.hadoop.hdfs.server.blockmanagement.HeartbeatManager$Monitor@4907c31:BlockTokenSecretManager@259] - Updating block keys
2023-07-02 17:26:42,143 - INFO  [Listener at localhost/35255:BlockManager@5081] - initializing replication queues
2023-07-02 17:26:42,143 - INFO  [Listener at localhost/35255:BlockManagerSafeMode@409] - STATE* Leaving safe mode after 0 secs
2023-07-02 17:26:42,143 - INFO  [Listener at localhost/35255:BlockManagerSafeMode@415] - STATE* Network topology has 0 racks and 0 datanodes
2023-07-02 17:26:42,143 - INFO  [Listener at localhost/35255:BlockManagerSafeMode@417] - STATE* UnderReplicatedBlocks has 0 blocks
2023-07-02 17:26:42,173 - INFO  [Listener at localhost/35255:AbstractDelegationTokenSecretManager@367] - Updating the current master key for generating delegation tokens
2023-07-02 17:26:42,232 - INFO  [Thread[Thread-39,5,main]:AbstractDelegationTokenSecretManager$ExpiredTokenRemover@701] - Starting expired delegation token remover thread, tokenRemoverScanInterval=60 min(s)
2023-07-02 17:26:42,233 - INFO  [Thread[Thread-39,5,main]:AbstractDelegationTokenSecretManager@367] - Updating the current master key for generating delegation tokens
2023-07-02 17:26:42,235 - INFO  [Reconstruction Queue Initializer:BlockManager@3726] - Total number of blocks            = 0
2023-07-02 17:26:42,235 - INFO  [Reconstruction Queue Initializer:BlockManager@3727] - Number of invalid blocks          = 0
2023-07-02 17:26:42,235 - INFO  [Reconstruction Queue Initializer:BlockManager@3728] - Number of under-replicated blocks = 0
2023-07-02 17:26:42,235 - INFO  [Reconstruction Queue Initializer:BlockManager@3729] - Number of  over-replicated blocks = 0
2023-07-02 17:26:42,236 - INFO  [Reconstruction Queue Initializer:BlockManager@3731] - Number of blocks being written    = 0
2023-07-02 17:26:42,236 - INFO  [Reconstruction Queue Initializer:BlockManager@3734] - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 93 msec
2023-07-02 17:26:42,264 - INFO  [IPC Server Responder:Server$Responder@1631] - IPC Server Responder: starting
2023-07-02 17:26:42,264 - INFO  [IPC Server listener on 0:Server$Listener@1471] - IPC Server listener on 0: starting
2023-07-02 17:26:42,267 - INFO  [Listener at localhost/35255:NameNode@892] - NameNode RPC up at: localhost/127.0.0.1:35255
2023-07-02 17:26:42,306 - INFO  [Listener at localhost/35255:FSNamesystem@1376] - Starting services required for active state
2023-07-02 17:26:42,306 - INFO  [Listener at localhost/35255:FSDirectory@849] - Initializing quota with 12 thread(s)
2023-07-02 17:26:42,315 - INFO  [Listener at localhost/35255:FSDirectory@858] - Quota initialization completed in 8 milliseconds
name space=1
storage space=0
storage types=RAM_DISK=0, SSD=0, DISK=0, ARCHIVE=0, PROVIDED=0, NVDIMM=0
2023-07-02 17:26:42,319 - INFO  [CacheReplicationMonitor(1028992775):CacheReplicationMonitor@160] - Starting CacheReplicationMonitor with interval 30000 milliseconds
2023-07-02 17:26:42,327 - INFO  [Listener at localhost/35255:MiniDFSCluster@1726] - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1,[DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2
2023-07-02 17:26:42,342 - INFO  [pool-1-thread-1:KdcRequest@651] - The preauth data is empty.
2023-07-02 17:26:42,342 - INFO  [pool-1-thread-1:KdcHandler@177] - KRB error occurred while processing request:Additional pre-authentication required
2023-07-02 17:26:42,352 - INFO  [pool-1-thread-1:AsRequest@112] - AS_REQ ISSUE: authtime 1688333202351,hdfs/localhost@EXAMPLE.COM for krbtgt/EXAMPLE.COM@EXAMPLE.COM
2023-07-02 17:26:42,355 - INFO  [Listener at localhost/35255:UserGroupInformation@1128] - Login successful for user hdfs/localhost@EXAMPLE.COM using keytab file hdfs.keytab. Keytab auto renewal enabled : false
2023-07-02 17:26:42,390 - INFO  [Listener at localhost/35255:ThrottledAsyncChecker@137] - Scheduling a check for [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1
2023-07-02 17:26:42,403 - INFO  [Listener at localhost/35255:ThrottledAsyncChecker@137] - Scheduling a check for [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2
2023-07-02 17:26:42,420 - INFO  [Listener at localhost/35255:MetricsSystemImpl@158] - DataNode metrics system started (again)
2023-07-02 17:26:42,423 - INFO  [Listener at localhost/35255:Util@428] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2023-07-02 17:26:42,426 - INFO  [Listener at localhost/35255:BlockScanner@201] - Initialized block scanner with targetBytesPerSec 1048576
2023-07-02 17:26:42,430 - INFO  [Listener at localhost/35255:DataNode@505] - Configured hostname is 127.0.0.1
2023-07-02 17:26:42,431 - INFO  [Listener at localhost/35255:Util@428] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2023-07-02 17:26:42,435 - INFO  [Listener at localhost/35255:DataNode@1465] - Starting DataNode with maxLockedMemory = 0
2023-07-02 17:26:42,439 - INFO  [Listener at localhost/35255:DataNode@1228] - Opened streaming server at /127.0.0.1:41879
2023-07-02 17:26:42,441 - INFO  [Listener at localhost/35255:DataXceiverServer$BlockBalanceThrottler@94] - Balancing bandwidth is 104857600 bytes/s
2023-07-02 17:26:42,441 - INFO  [Listener at localhost/35255:DataXceiverServer$BlockBalanceThrottler@95] - Number threads for balancing is 100
2023-07-02 17:26:42,448 - WARN  [Listener at localhost/35255:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets. Reason: Could not read signature secret file: /home/tonypan/hadoop-http-auth-signature-secret
2023-07-02 17:26:42,449 - INFO  [Listener at localhost/35255:HttpRequestLog@82] - Http request log for http.requests.datanode is not defined
2023-07-02 17:26:42,450 - INFO  [Listener at localhost/35255:HttpServer2@1155] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2023-07-02 17:26:42,451 - INFO  [Listener at localhost/35255:HttpServer2@1128] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2023-07-02 17:26:42,451 - INFO  [Listener at localhost/35255:HttpServer2@1138] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2023-07-02 17:26:42,453 - INFO  [Listener at localhost/35255:HttpServer2@1386] - Jetty bound to port 38697
2023-07-02 17:26:42,454 - INFO  [Listener at localhost/35255:Server@375] - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_275-8u275-b01-0ubuntu1~18.04-b01
2023-07-02 17:26:42,455 - INFO  [Listener at localhost/35255:DefaultSessionIdManager@334] - DefaultSessionIdManager workerName=node0
2023-07-02 17:26:42,455 - INFO  [Listener at localhost/35255:DefaultSessionIdManager@339] - No SessionScavenger set, using defaults
2023-07-02 17:26:42,456 - INFO  [Listener at localhost/35255:HouseKeeper@132] - node0 Scavenging every 660000ms
2023-07-02 17:26:42,457 - INFO  [Listener at localhost/35255:ContextHandler@915] - Started o.e.j.s.ServletContextHandler@58187645{static,/static,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/static/,AVAILABLE}
2023-07-02 17:26:42,466 - INFO  [Listener at localhost/35255:ContextHandler@915] - Started o.e.j.w.WebAppContext@59f991f9{datanode,/,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/datanode/,AVAILABLE}{file:/home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/datanode}
2023-07-02 17:26:42,468 - INFO  [Listener at localhost/35255:AbstractConnector@331] - Started ServerConnector@596e7170{HTTP/1.1, (http/1.1)}{localhost:38697}
2023-07-02 17:26:42,468 - INFO  [Listener at localhost/35255:Server@415] - Started @6566ms
2023-07-02 17:26:42,566 - WARN  [Listener at localhost/35255:RestCsrfPreventionFilterHandler@75] - Got null for restCsrfPreventionFilter - will not do any filtering.
2023-07-02 17:26:42,678 - INFO  [Listener at localhost/35255:DatanodeHttpServer@339] - Listening HTTPS traffic on /127.0.0.1:43627
2023-07-02 17:26:42,679 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@34328fbf:JvmPauseMonitor$Monitor@185] - Starting JVM pause monitor
2023-07-02 17:26:42,679 - INFO  [Listener at localhost/35255:DataNode@1493] - dnUserName = hdfs/localhost@EXAMPLE.COM
2023-07-02 17:26:42,680 - INFO  [Listener at localhost/35255:DataNode@1494] - supergroup = supergroup
2023-07-02 17:26:42,692 - INFO  [Listener at localhost/35255:CallQueueManager@93] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2023-07-02 17:26:42,693 - INFO  [Socket Reader #1 for port 0:Server$Listener$Reader@1392] - Starting Socket Reader #1 for port 0
2023-07-02 17:26:42,697 - INFO  [Listener at localhost/43203:DataNode@1115] - Opened IPC server at /127.0.0.1:43203
2023-07-02 17:26:42,718 - INFO  [Listener at localhost/43203:BlockPoolManager@150] - Refresh request received for nameservices: null
2023-07-02 17:26:42,718 - INFO  [Listener at localhost/43203:BlockPoolManager@211] - Starting BPOfferServices for nameservices: <default>
2023-07-02 17:26:42,725 - INFO  [Thread-75:BPServiceActor@871] - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35255 starting to offer service
2023-07-02 17:26:42,728 - INFO  [IPC Server Responder:Server$Responder@1631] - IPC Server Responder: starting
2023-07-02 17:26:42,729 - INFO  [IPC Server listener on 0:Server$Listener@1471] - IPC Server listener on 0: starting
2023-07-02 17:26:42,868 - INFO  [pool-1-thread-1:TgsRequest@115] - TGS_REQ ISSUE: authtime 1688333202867,hdfs/localhost for hdfs/localhost@EXAMPLE.COM
2023-07-02 17:26:42,892 - INFO  [Socket Reader #1 for port 0:Server$Connection@2189] - Auth successful for hdfs/localhost@EXAMPLE.COM (auth:KERBEROS) from 127.0.0.1:44229
2023-07-02 17:26:42,979 - INFO  [Socket Reader #1 for port 0:Server$Connection@2189] - Auth successful for hdfs/localhost@EXAMPLE.COM (auth:KERBEROS) from 127.0.0.1:43347
2023-07-02 17:26:43,023 - INFO  [Thread-75:BPOfferService@381] - Acknowledging ACTIVE Namenode during handshake Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35255
2023-07-02 17:26:43,026 - INFO  [Thread-75:DataStorage@356] - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2023-07-02 17:26:43,034 - WARN  [IPC Server handler 1 on default port 35255:ShellBasedUnixGroupsMapping@218] - unable to return groups for user hdfs
PartialGroupNameException The user name 'hdfs' is not found. id: ‘hdfs’: no such user
id: ‘hdfs’: no such user

	at org.apache.hadoop.security.ShellBasedUnixGroupsMapping.resolvePartialGroupNames(ShellBasedUnixGroupsMapping.java:291)
	at org.apache.hadoop.security.ShellBasedUnixGroupsMapping.getUnixGroups(ShellBasedUnixGroupsMapping.java:215)
	at org.apache.hadoop.security.ShellBasedUnixGroupsMapping.getGroupsSet(ShellBasedUnixGroupsMapping.java:123)
	at org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback.getGroupsSet(JniBasedUnixGroupsMappingWithFallback.java:67)
	at org.apache.hadoop.security.Groups$GroupCacheLoader.fetchGroupSet(Groups.java:415)
	at org.apache.hadoop.security.Groups$GroupCacheLoader.load(Groups.java:353)
	at org.apache.hadoop.security.Groups$GroupCacheLoader.load(Groups.java:302)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache.get(LocalCache.java:3962)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3985)
	at org.apache.hadoop.thirdparty.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4946)
	at org.apache.hadoop.security.Groups.getGroupInternal(Groups.java:260)
	at org.apache.hadoop.security.Groups.getGroupsSet(Groups.java:232)
	at org.apache.hadoop.security.UserGroupInformation.getGroupsSet(UserGroupInformation.java:1756)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.<init>(FSPermissionChecker.java:106)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.getPermissionChecker(FSDirectory.java:1867)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.getPermissionChecker(FSDirectory.java:1856)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getPermissionChecker(FSNamesystem.java:3391)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkSuperuserPrivilege(FSNamesystem.java:8964)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkSuperuserPrivilege(FSNamesystem.java:5302)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.datanodeReport(FSNamesystem.java:4925)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getDatanodeReport(NameNodeRpcServer.java:1266)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getDatanodeReport(ClientNamenodeProtocolServerSideTranslatorPB.java:888)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:604)
	at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:572)
	at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1162)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1085)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1900)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3099)
2023-07-02 17:26:43,061 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,062 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,066 - INFO  [Thread-75:Storage$StorageDirectory@948] - Lock on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 32519@razor7
2023-07-02 17:26:43,067 - INFO  [Thread-75:DataStorage@284] - Storage directory with location [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1 is not formatted for namespace 874112721. Formatting...
2023-07-02 17:26:43,069 - INFO  [Thread-75:DataStorage@160] - Generated new storageID DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd for directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1 
2023-07-02 17:26:43,150 - INFO  [Thread-75:Storage$StorageDirectory@948] - Lock on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 32519@razor7
2023-07-02 17:26:43,150 - INFO  [Thread-75:DataStorage@284] - Storage directory with location [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2 is not formatted for namespace 874112721. Formatting...
2023-07-02 17:26:43,150 - INFO  [Thread-75:DataStorage@160] - Generated new storageID DS-831f1eb7-0a0e-48f7-b195-67898b430043 for directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2 
2023-07-02 17:26:43,164 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,164 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,228 - INFO  [Thread-75:BlockPoolSliceStorage@255] - Analyzing storage directories for bpid BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,228 - INFO  [Thread-75:Storage$StorageDirectory@907] - Locking is disabled for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/current/BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,229 - INFO  [Thread-75:BlockPoolSliceStorage@168] - Block pool storage directory for location [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1 and block pool id BP-3175952-10.0.0.207-1688333198822 is not formatted. Formatting ...
2023-07-02 17:26:43,229 - INFO  [Thread-75:BlockPoolSliceStorage@284] - Formatting block pool BP-3175952-10.0.0.207-1688333198822 directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/current/BP-3175952-10.0.0.207-1688333198822/current
2023-07-02 17:26:43,267 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,267 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,310 - INFO  [Thread-75:BlockPoolSliceStorage@255] - Analyzing storage directories for bpid BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,310 - INFO  [Thread-75:Storage$StorageDirectory@907] - Locking is disabled for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/current/BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,311 - INFO  [Thread-75:BlockPoolSliceStorage@168] - Block pool storage directory for location [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2 and block pool id BP-3175952-10.0.0.207-1688333198822 is not formatted. Formatting ...
2023-07-02 17:26:43,311 - INFO  [Thread-75:BlockPoolSliceStorage@284] - Formatting block pool BP-3175952-10.0.0.207-1688333198822 directory /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/current/BP-3175952-10.0.0.207-1688333198822/current
2023-07-02 17:26:43,369 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,370 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,377 - INFO  [Thread-75:DataNode@1813] - Setting up storage: nsid=874112721;bpid=BP-3175952-10.0.0.207-1688333198822;lv=-57;nsInfo=lv=-67;cid=testClusterID;nsid=874112721;c=1688333198822;bpid=BP-3175952-10.0.0.207-1688333198822;dnuuid=null
2023-07-02 17:26:43,444 - INFO  [Thread-75:DataNode@1611] - Generated and persisted new Datanode UUID afce0b8a-283d-419e-ae89-d01b491979d8
2023-07-02 17:26:43,466 - INFO  [Thread-75:FsDatasetImpl@322] - The datanode lock is a read write lock
2023-07-02 17:26:43,472 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,472 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,481 - INFO  [Thread-75:RoundRobinVolumeChoosingPolicy@67] - Round robin volume choosing policy initialized: dfs.datanode.round-robin-volume-choosing-policy.additional-available-space = 0
2023-07-02 17:26:43,575 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,575 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,580 - INFO  [Thread-75:FsVolumeList@365] - Added new volume: DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd
2023-07-02 17:26:43,581 - INFO  [Thread-75:FsDatasetImpl@524] - Added volume - [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1, StorageType: DISK
2023-07-02 17:26:43,583 - INFO  [Thread-75:FsVolumeList@365] - Added new volume: DS-831f1eb7-0a0e-48f7-b195-67898b430043
2023-07-02 17:26:43,583 - INFO  [Thread-75:FsDatasetImpl@524] - Added volume - [DISK]file:/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2, StorageType: DISK
2023-07-02 17:26:43,588 - INFO  [Thread-75:MemoryMappableBlockLoader@47] - Initializing cache loader: MemoryMappableBlockLoader.
2023-07-02 17:26:43,594 - INFO  [Thread-75:FsDatasetImpl@2546] - Registered FSDatasetState MBean
2023-07-02 17:26:43,601 - INFO  [Thread-75:FsDatasetImpl@3089] - Adding block pool BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,602 - INFO  [Thread-95:FsVolumeList$2@478] - Scanning block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1...
2023-07-02 17:26:43,603 - INFO  [Thread-96:FsVolumeList$2@478] - Scanning block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2...
2023-07-02 17:26:43,616 - WARN  [Thread-95:BlockPoolSlice@305] - dfsUsed file missing in /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/current/BP-3175952-10.0.0.207-1688333198822/current, will proceed with Du for space computation calculation, 
2023-07-02 17:26:43,616 - WARN  [Thread-96:BlockPoolSlice@305] - dfsUsed file missing in /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/current/BP-3175952-10.0.0.207-1688333198822/current, will proceed with Du for space computation calculation, 
2023-07-02 17:26:43,655 - INFO  [Thread-96:FsVolumeList$2@483] - Time taken to scan block pool BP-3175952-10.0.0.207-1688333198822 on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2: 52ms
2023-07-02 17:26:43,658 - INFO  [Thread-95:FsVolumeList$2@483] - Time taken to scan block pool BP-3175952-10.0.0.207-1688333198822 on /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1: 55ms
2023-07-02 17:26:43,658 - INFO  [Thread-75:FsVolumeList@503] - Total time to scan all replicas for block pool BP-3175952-10.0.0.207-1688333198822: 56ms
2023-07-02 17:26:43,659 - INFO  [Thread-99:FsVolumeList$1@253] - Adding replicas to map for block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1...
2023-07-02 17:26:43,659 - INFO  [Thread-100:FsVolumeList$1@253] - Adding replicas to map for block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2...
2023-07-02 17:26:43,660 - INFO  [Thread-99:BlockPoolSlice@921] - Replica Cache file: /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/current/BP-3175952-10.0.0.207-1688333198822/current/replicas doesn't exist 
2023-07-02 17:26:43,660 - INFO  [Thread-100:BlockPoolSlice@921] - Replica Cache file: /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/current/BP-3175952-10.0.0.207-1688333198822/current/replicas doesn't exist 
2023-07-02 17:26:43,662 - INFO  [Thread-100:FsVolumeList$1@258] - Time to add replicas to map for block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2: 3ms
2023-07-02 17:26:43,662 - INFO  [Thread-99:FsVolumeList$1@258] - Time to add replicas to map for block pool BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1: 3ms
2023-07-02 17:26:43,663 - INFO  [Thread-75:FsVolumeList@279] - Total time to add all replicas to map for block pool BP-3175952-10.0.0.207-1688333198822: 5ms
2023-07-02 17:26:43,663 - INFO  [Thread-75:ThrottledAsyncChecker@137] - Scheduling a check for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1
2023-07-02 17:26:43,672 - INFO  [Thread-75:DatasetVolumeChecker@224] - Scheduled health check for volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1
2023-07-02 17:26:43,673 - INFO  [Thread-75:ThrottledAsyncChecker@137] - Scheduling a check for /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2
2023-07-02 17:26:43,673 - INFO  [Thread-75:DatasetVolumeChecker@224] - Scheduled health check for volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2
2023-07-02 17:26:43,675 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2):VolumeScanner@385] - Now scanning bpid BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2
2023-07-02 17:26:43,676 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1):VolumeScanner@385] - Now scanning bpid BP-3175952-10.0.0.207-1688333198822 on volume /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1
2023-07-02 17:26:43,678 - WARN  [Thread-75:DirectoryScanner@301] - dfs.datanode.directoryscan.throttle.limit.ms.per.sec set to value above 1000 ms/sec. Assuming default value of -1
2023-07-02 17:26:43,679 - INFO  [Thread-75:DirectoryScanner@366] - Periodic Directory Tree Verification scan starting in 15004218ms with interval of 21600000ms and throttle limit of -1ms/s
2023-07-02 17:26:43,679 - INFO  [Listener at localhost/43203:MiniDFSCluster@2859] - dnInfo.length != numDataNodes
2023-07-02 17:26:43,679 - INFO  [Listener at localhost/43203:MiniDFSCluster@2780] - Waiting for cluster to become active
2023-07-02 17:26:43,679 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2):VolumeScanner@505] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2, DS-831f1eb7-0a0e-48f7-b195-67898b430043): finished scanning block pool BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,679 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1):VolumeScanner@505] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1, DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd): finished scanning block pool BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,684 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BPServiceActor@812] - Block pool BP-3175952-10.0.0.207-1688333198822 (Datanode Uuid afce0b8a-283d-419e-ae89-d01b491979d8) service to localhost/127.0.0.1:35255 beginning handshake with NN
2023-07-02 17:26:43,701 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2):VolumeScanner@402] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2, DS-831f1eb7-0a0e-48f7-b195-67898b430043): no suitable block pools found to scan.  Waiting 1814399974 ms.
2023-07-02 17:26:43,701 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1):VolumeScanner@402] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1, DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd): no suitable block pools found to scan.  Waiting 1814399974 ms.
2023-07-02 17:26:43,702 - INFO  [IPC Server handler 5 on default port 35255:DatanodeManager@1154] - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:41879, datanodeUuid=afce0b8a-283d-419e-ae89-d01b491979d8, infoPort=0, infoSecurePort=43627, ipcPort=43203, storageInfo=lv=-57;cid=testClusterID;nsid=874112721;c=1688333198822) storage afce0b8a-283d-419e-ae89-d01b491979d8
2023-07-02 17:26:43,704 - INFO  [IPC Server handler 5 on default port 35255:NetworkTopology@149] - Adding a new node: /default-rack/127.0.0.1:41879
2023-07-02 17:26:43,705 - INFO  [IPC Server handler 5 on default port 35255:BlockReportLeaseManager@200] - Registered DN afce0b8a-283d-419e-ae89-d01b491979d8 (127.0.0.1:41879).
2023-07-02 17:26:43,719 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BPServiceActor@840] - Block pool BP-3175952-10.0.0.207-1688333198822 (Datanode Uuid afce0b8a-283d-419e-ae89-d01b491979d8) service to localhost/127.0.0.1:35255 successfully registered with NN
2023-07-02 17:26:43,720 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:DataNode@1680] - Block token params received from NN: for block pool BP-3175952-10.0.0.207-1688333198822 keyUpdateInterval=600 min(s), tokenLifetime=600 min(s)
2023-07-02 17:26:43,720 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BlockTokenSecretManager@155] - Block token key range: [0, 2147483647)
2023-07-02 17:26:43,720 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BlockTokenSecretManager@229] - Setting block keys. BlockPool = BP-3175952-10.0.0.207-1688333198822 .
2023-07-02 17:26:43,721 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BPServiceActor@673] - For namenode localhost/127.0.0.1:35255 using BLOCKREPORT_INTERVAL of 21600000msecs CACHEREPORT_INTERVAL of 10000msecs Initial delay: 0msecs; heartBeatInterval=3000
2023-07-02 17:26:43,721 - INFO  [ibr-executor-0:BPServiceActor$IBRTaskHandler@1139] - Starting IBR Task Handler.
2023-07-02 17:26:43,738 - INFO  [IPC Server handler 3 on default port 35255:DatanodeDescriptor@1010] - Adding new storage ID DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd for DN 127.0.0.1:41879
2023-07-02 17:26:43,739 - INFO  [IPC Server handler 3 on default port 35255:DatanodeDescriptor@1010] - Adding new storage ID DS-831f1eb7-0a0e-48f7-b195-67898b430043 for DN 127.0.0.1:41879
2023-07-02 17:26:43,770 - INFO  [Block report processor:BlockManager@2777] - BLOCK* processReport 0xc292799817d59e42: Processing first storage report for DS-831f1eb7-0a0e-48f7-b195-67898b430043 from datanode DatanodeRegistration(127.0.0.1:41879, datanodeUuid=afce0b8a-283d-419e-ae89-d01b491979d8, infoPort=0, infoSecurePort=43627, ipcPort=43203, storageInfo=lv=-57;cid=testClusterID;nsid=874112721;c=1688333198822)
2023-07-02 17:26:43,772 - INFO  [Block report processor:BlockManager@2809] - BLOCK* processReport 0xc292799817d59e42: from storage DS-831f1eb7-0a0e-48f7-b195-67898b430043 node DatanodeRegistration(127.0.0.1:41879, datanodeUuid=afce0b8a-283d-419e-ae89-d01b491979d8, infoPort=0, infoSecurePort=43627, ipcPort=43203, storageInfo=lv=-57;cid=testClusterID;nsid=874112721;c=1688333198822), blocks: 0, hasStaleStorage: true, processing time: 2 msecs, invalidatedBlocks: 0
2023-07-02 17:26:43,773 - INFO  [Block report processor:BlockManager@2777] - BLOCK* processReport 0xc292799817d59e42: Processing first storage report for DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd from datanode DatanodeRegistration(127.0.0.1:41879, datanodeUuid=afce0b8a-283d-419e-ae89-d01b491979d8, infoPort=0, infoSecurePort=43627, ipcPort=43203, storageInfo=lv=-57;cid=testClusterID;nsid=874112721;c=1688333198822)
2023-07-02 17:26:43,773 - INFO  [Block report processor:BlockManager@2809] - BLOCK* processReport 0xc292799817d59e42: from storage DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd node DatanodeRegistration(127.0.0.1:41879, datanodeUuid=afce0b8a-283d-419e-ae89-d01b491979d8, infoPort=0, infoSecurePort=43627, ipcPort=43203, storageInfo=lv=-57;cid=testClusterID;nsid=874112721;c=1688333198822), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2023-07-02 17:26:43,788 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BPServiceActor@457] - Successfully sent block report 0xc292799817d59e42 to namenode: localhost/127.0.0.1:35255,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 3 msecs to generate and 32 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2023-07-02 17:26:43,790 - INFO  [Command processor:BPOfferService@763] - Got finalize command for block pool BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:43,793 - INFO  [Listener at localhost/43203:MiniDFSCluster@2835] - Cluster is active
2023-07-02 17:26:43,805 - INFO  [Listener at localhost/43203:MiniDFSCluster@2835] - Cluster is active
2023-07-02 17:26:43,980 - INFO  [IPC Server handler 0 on default port 35255:FSDirWriteFileOp@802] - BLOCK* allocate blk_1073741825_1001, replicas=127.0.0.1:41879 for /file1
2023-07-02 17:26:45,145 - INFO  [DataXceiver for client DFSClient_NONMAPREDUCE_-1623945710_22 at /127.0.0.1:34164 [Receiving block BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001]:DataXceiver@748] - Receiving BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001 src: /127.0.0.1:34164 dest: /127.0.0.1:41879
2023-07-02 17:26:45,176 - INFO  [PacketResponder: BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001, type=LAST_IN_PIPELINE:BlockReceiver$PacketResponder@1555] - src: /127.0.0.1:34164, dest: /127.0.0.1:41879, volume: /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1, bytes: 8192, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-1623945710_22, offset: 0, srvID: afce0b8a-283d-419e-ae89-d01b491979d8, blockid: BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001, duration(ns): 10497832
2023-07-02 17:26:45,177 - INFO  [PacketResponder: BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001, type=LAST_IN_PIPELINE:BlockReceiver$PacketResponder@1528] - PacketResponder: BP-3175952-10.0.0.207-1688333198822:blk_1073741825_1001, type=LAST_IN_PIPELINE terminating
2023-07-02 17:26:45,186 - INFO  [IPC Server handler 0 on default port 35255:FSNamesystem@3269] - BLOCK* blk_1073741825_1001 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /file1
2023-07-02 17:26:45,593 - INFO  [IPC Server handler 8 on default port 35255:FSNamesystem@3222] - DIR* completeFile: /file1 is closed by DFSClient_NONMAPREDUCE_-1623945710_22
2023-07-02 17:26:45,737 - INFO  [Listener at localhost/43203:MiniDFSCluster@2116] - Shutting down the Mini HDFS Cluster
2023-07-02 17:26:45,737 - INFO  [Listener at localhost/43203:MiniDFSCluster@2164] - Shutting down DataNode 0
2023-07-02 17:26:45,739 - INFO  [Listener at localhost/43203:DirectoryScanner@429] - Shutdown has been called
2023-07-02 17:26:45,739 - INFO  [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2f2928c3:DataXceiverServer@396] - Closing all peers.
2023-07-02 17:26:45,741 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2):VolumeScanner@672] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2, DS-831f1eb7-0a0e-48f7-b195-67898b430043) exiting.
2023-07-02 17:26:45,741 - INFO  [VolumeScannerThread(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1):VolumeScanner@672] - VolumeScanner(/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1, DS-feb1e3ad-e9e4-4b40-b24d-4d622aeda5cd) exiting.
2023-07-02 17:26:45,790 - INFO  [Listener at localhost/43203:ContextHandler@1153] - Stopped o.e.j.w.WebAppContext@59f991f9{datanode,/,null,STOPPED}{file:/home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/datanode}
2023-07-02 17:26:45,796 - INFO  [Listener at localhost/43203:AbstractConnector@381] - Stopped ServerConnector@596e7170{HTTP/1.1, (http/1.1)}{localhost:0}
2023-07-02 17:26:45,796 - INFO  [Listener at localhost/43203:HouseKeeper@149] - node0 Stopped scavenging
2023-07-02 17:26:45,797 - INFO  [Listener at localhost/43203:ContextHandler@1153] - Stopped o.e.j.s.ServletContextHandler@58187645{static,/static,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/static/,STOPPED}
2023-07-02 17:26:45,799 - INFO  [Listener at localhost/43203:DataNode@2146] - Waiting up to 30 seconds for transfer threads to complete
2023-07-02 17:26:45,799 - INFO  [Listener at localhost/43203:Server@3553] - Stopping server on 43203
2023-07-02 17:26:45,803 - INFO  [IPC Server listener on 0:Server$Listener@1503] - Stopping IPC Server listener on 0
2023-07-02 17:26:45,804 - INFO  [IPC Server Responder:Server$Responder@1636] - Stopping IPC Server Responder
2023-07-02 17:26:45,805 - WARN  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:IncrementalBlockReportManager@160] - IncrementalBlockReportManager interrupted
2023-07-02 17:26:45,805 - ERROR [Command processor:BPServiceActor$CommandProcessingThread@1410] - Command processor encountered interrupt and exit.
2023-07-02 17:26:45,806 - WARN  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BPServiceActor@918] - Ending block pool service for: Block pool BP-3175952-10.0.0.207-1688333198822 (Datanode Uuid afce0b8a-283d-419e-ae89-d01b491979d8) service to localhost/127.0.0.1:35255
2023-07-02 17:26:45,806 - WARN  [Command processor:BPServiceActor$CommandProcessingThread@1394] - Ending command processor service for: Thread[Command processor,5,main]
2023-07-02 17:26:45,806 - WARN  [ibr-executor-0:IncrementalBlockReportManager@160] - IncrementalBlockReportManager interrupted
2023-07-02 17:26:45,808 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:BlockPoolManager@103] - Removed Block pool BP-3175952-10.0.0.207-1688333198822 (Datanode Uuid afce0b8a-283d-419e-ae89-d01b491979d8)
2023-07-02 17:26:45,808 - INFO  [BP-3175952-10.0.0.207-1688333198822 heartbeating to localhost/127.0.0.1:35255:FsDatasetImpl@3122] - Removing block pool BP-3175952-10.0.0.207-1688333198822
2023-07-02 17:26:45,810 - WARN  [refreshUsed-/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data1/current/BP-3175952-10.0.0.207-1688333198822:CachingGetSpaceUsed$RefreshThread@211] - Thread Interrupted waiting to refresh disk information: sleep interrupted
2023-07-02 17:26:45,810 - WARN  [refreshUsed-/home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/data/data2/current/BP-3175952-10.0.0.207-1688333198822:CachingGetSpaceUsed$RefreshThread@211] - Thread Interrupted waiting to refresh disk information: sleep interrupted
2023-07-02 17:26:45,813 - INFO  [Listener at localhost/43203:FsDatasetAsyncDiskService@201] - Shutting down all async disk service threads
2023-07-02 17:26:45,813 - INFO  [Listener at localhost/43203:FsDatasetAsyncDiskService@209] - All async disk service threads have been shut down
2023-07-02 17:26:45,814 - INFO  [Listener at localhost/43203:RamDiskAsyncLazyPersistService@186] - Shutting down all async lazy persist service threads
2023-07-02 17:26:45,814 - INFO  [Listener at localhost/43203:RamDiskAsyncLazyPersistService@193] - All async lazy persist service threads have been shut down
2023-07-02 17:26:45,815 - INFO  [Listener at localhost/43203:DataNode@2235] - Shutdown complete.
2023-07-02 17:26:45,815 - INFO  [Listener at localhost/43203:MiniDFSCluster@2197] - Shutting down the namenode
2023-07-02 17:26:45,816 - INFO  [Listener at localhost/43203:FSNamesystem@1493] - Stopping services started for active state
2023-07-02 17:26:45,816 - ERROR [Thread[Thread-39,5,main]:AbstractDelegationTokenSecretManager$ExpiredTokenRemover@722] - ExpiredTokenRemover received java.lang.InterruptedException: sleep interrupted
2023-07-02 17:26:45,816 - INFO  [Listener at localhost/43203:FSEditLog@1460] - Ending log segment 1, 8
2023-07-02 17:26:45,816 - INFO  [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$LazyPersistFileScrubber@54926e9e:FSNamesystem$LazyPersistFileScrubber@4662] - LazyPersistFileScrubber was interrupted, exiting
2023-07-02 17:26:45,818 - INFO  [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller@713dfddc:FSNamesystem$NameNodeEditLogRoller@4566] - NameNodeEditLogRoller was interrupted, exiting
2023-07-02 17:26:45,871 - INFO  [Listener at localhost/43203:FSEditLog@796] - Number of transactions: 9 Total time for transactions(ms): 22 Number of transactions batched in Syncs: 1 Number of syncs: 9 SyncTimes(ms): 313 260 
2023-07-02 17:26:45,873 - INFO  [Listener at localhost/43203:FileJournalManager@145] - Finalizing edits file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000001 -> /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-1/current/edits_0000000000000000001-0000000000000000009
2023-07-02 17:26:45,874 - INFO  [Listener at localhost/43203:FileJournalManager@145] - Finalizing edits file /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000001 -> /home/tonypan/flaky-reproduction/experiment/hdfs-16332/target/test/data/dfs/name-0-2/current/edits_0000000000000000001-0000000000000000009
2023-07-02 17:26:45,875 - INFO  [FSEditLogAsync:FSEditLogAsync@276] - FSEditLogAsync was interrupted, exiting
2023-07-02 17:26:45,875 - INFO  [CacheReplicationMonitor(1028992775):CacheReplicationMonitor@169] - Shutting down CacheReplicationMonitor
2023-07-02 17:26:45,877 - INFO  [Listener at localhost/43203:Server@3553] - Stopping server on 35255
2023-07-02 17:26:45,880 - INFO  [IPC Server Responder:Server$Responder@1636] - Stopping IPC Server Responder
2023-07-02 17:26:45,880 - INFO  [IPC Server listener on 0:Server$Listener@1503] - Stopping IPC Server listener on 0
2023-07-02 17:26:45,883 - INFO  [RedundancyMonitor:BlockManager$RedundancyMonitor@4931] - Stopping RedundancyMonitor.
2023-07-02 17:26:45,938 - INFO  [Listener at localhost/43203:FSNamesystem@1493] - Stopping services started for active state
2023-07-02 17:26:45,939 - INFO  [Listener at localhost/43203:FSNamesystem@1597] - Stopping services started for standby state
2023-07-02 17:26:45,940 - INFO  [Listener at localhost/43203:ContextHandler@1153] - Stopped o.e.j.w.WebAppContext@3ae86952{hdfs,/,null,STOPPED}{file:/home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/hdfs}
2023-07-02 17:26:45,944 - INFO  [Listener at localhost/43203:AbstractConnector@381] - Stopped ServerConnector@6723e217{SSL, (ssl, http/1.1)}{localhost:0}
2023-07-02 17:26:45,944 - INFO  [Listener at localhost/43203:HouseKeeper@149] - node0 Stopped scavenging
2023-07-02 17:26:45,945 - INFO  [Listener at localhost/43203:ContextHandler@1153] - Stopped o.e.j.s.ServletContextHandler@5ed67d97{static,/static,file:///home/tonypan/flaky-reproduction/systems/hdfs-16332/hadoop-hdfs-project/hadoop-hdfs/target/test-classes/webapps/static/,STOPPED}
2023-07-02 17:26:45,946 - INFO  [Listener at localhost/43203:MetricsSystemImpl@210] - Stopping DataNode metrics system...
2023-07-02 17:26:45,947 - INFO  [Listener at localhost/43203:MetricsSystemImpl@216] - DataNode metrics system stopped.
2023-07-02 17:26:45,948 - INFO  [Listener at localhost/43203:MetricsSystemImpl@611] - DataNode metrics system shutdown complete.
2023-07-02 17:26:45,974 - INFO  [main:DefaultInternalKdcServerImpl@102] - Default Internal kdc server stopped.
2023-07-02 17:26:46,975 - INFO  [main:MiniKdc@359] - MiniKdc stopped.

Time: 10.661

OK (1 test)

