SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-common-project/hadoop-auth-examples/target/hadoop-auth-examples-3.0.0-beta1-SNAPSHOT/WEB-INF/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/haoze/tmp/bytecode/hdfs-12248/classes/runtime-1.0-jar-with-dependencies.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
2022-05-18 01:47:41,969 - INFO  [main:LocalInjectionManager@110] - injection allow set: [0, 2, 11, 13, 17, 18, 19, 22, 23, 24]
JUnit version 4.11
.2022-05-18 01:47:42,153 - INFO  [Thread-0:MiniQJMHACluster@99] - Set MiniQJMHACluster basePort to 10052
2022-05-18 01:47:42,155 - INFO  [Thread-0:MiniJournalCluster@95] - Starting MiniJournalCluster with 3 journal nodes
2022-05-18 01:47:42,469 - INFO  [Thread-0:FluentPropertyBeanIntrospector@147] - Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2022-05-18 01:47:42,484 - WARN  [Thread-0:MetricsConfig@134] - Cannot locate configuration: tried hadoop-metrics2-journalnode.properties,hadoop-metrics2.properties
2022-05-18 01:47:42,577 - INFO  [Thread-0:MetricsSystemImpl@374] - Scheduled Metric snapshot period at 10 second(s).
2022-05-18 01:47:42,577 - INFO  [Thread-0:MetricsSystemImpl@191] - JournalNode metrics system started
2022-05-18 01:47:42,648 - WARN  [Thread-0:NativeCodeLoader@60] - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-05-18 01:47:42,692 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for journal at: http://localhost:0
2022-05-18 01:47:42,715 - INFO  [Thread-0:Log@192] - Logging initialized @2027ms
2022-05-18 01:47:42,800 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:42,812 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.journal is not defined
2022-05-18 01:47:42,815 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:42,817 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context journal
2022-05-18 01:47:42,817 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:42,836 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 42935
2022-05-18 01:47:42,838 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:42,863 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@21a7d37c{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:43,055 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@706fb166{/,file:///tmp/jetty-localhost-42935-journal-_-any-707328151600681699.dir/webapp/,AVAILABLE}{/journal}
2022-05-18 01:47:43,060 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@3812c91a{HTTP/1.1,[http/1.1]}{localhost:42935}
2022-05-18 01:47:43,061 - INFO  [Thread-0:Server@414] - Started @2372ms
2022-05-18 01:47:43,097 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 500 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:43,105 - INFO  [Socket Reader #1 for port 39473:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 39473
2022-05-18 01:47:44,992 - INFO  [IPC Server listener on 39473:Server$Listener@1146] - IPC Server listener on 39473: starting
2022-05-18 01:47:44,992 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:45,047 - INFO  [Thread-0:MetricsSystemImpl@158] - JournalNode metrics system started (again)
2022-05-18 01:47:45,049 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for journal at: http://localhost:0
2022-05-18 01:47:45,051 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:45,052 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.journal is not defined
2022-05-18 01:47:45,053 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:45,054 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context journal
2022-05-18 01:47:45,054 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:45,055 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 45963
2022-05-18 01:47:45,055 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:45,057 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@290f9c56{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:45,174 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@65508f18{/,file:///tmp/jetty-localhost-45963-journal-_-any-4686782318497985160.dir/webapp/,AVAILABLE}{/journal}
2022-05-18 01:47:45,175 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@ab176dd{HTTP/1.1,[http/1.1]}{localhost:45963}
2022-05-18 01:47:45,175 - INFO  [Thread-0:Server@414] - Started @4487ms
2022-05-18 01:47:45,177 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 500 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:45,197 - INFO  [Socket Reader #1 for port 44035:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 44035
2022-05-18 01:47:45,201 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:45,201 - INFO  [IPC Server listener on 44035:Server$Listener@1146] - IPC Server listener on 44035: starting
2022-05-18 01:47:45,239 - INFO  [Thread-0:MetricsSystemImpl@158] - JournalNode metrics system started (again)
2022-05-18 01:47:45,241 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for journal at: http://localhost:0
2022-05-18 01:47:45,243 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:45,244 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.journal is not defined
2022-05-18 01:47:45,244 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:45,245 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context journal
2022-05-18 01:47:45,245 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:45,246 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 43719
2022-05-18 01:47:45,246 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:45,249 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@30ee8c83{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:45,359 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@23b06aa7{/,file:///tmp/jetty-localhost-43719-journal-_-any-5081036837578903464.dir/webapp/,AVAILABLE}{/journal}
2022-05-18 01:47:45,362 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@45badd20{HTTP/1.1,[http/1.1]}{localhost:43719}
2022-05-18 01:47:45,362 - INFO  [Thread-0:Server@414] - Started @4674ms
2022-05-18 01:47:45,363 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 500 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:45,364 - INFO  [Socket Reader #1 for port 41483:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 41483
2022-05-18 01:47:45,367 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:45,367 - INFO  [IPC Server listener on 41483:Server$Listener@1146] - IPC Server listener on 41483: starting
2022-05-18 01:47:45,785 - INFO  [IPC Server handler 0 on 44035:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/waitactive
2022-05-18 01:47:45,785 - INFO  [IPC Server handler 0 on 41483:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/waitactive
2022-05-18 01:47:45,785 - INFO  [IPC Server handler 1 on 39473:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/waitactive
2022-05-18 01:47:45,794 - WARN  [IPC Server handler 0 on 44035:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/waitactive does not exist
2022-05-18 01:47:45,794 - WARN  [IPC Server handler 0 on 41483:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/waitactive does not exist
2022-05-18 01:47:45,794 - WARN  [IPC Server handler 1 on 39473:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/waitactive does not exist
2022-05-18 01:47:46,167 - INFO  [Thread-0:MiniDFSCluster@469] - starting cluster: numNameNodes=2, numDataNodes=0
Formatting using clusterid: testClusterID
2022-05-18 01:47:46,306 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:46,311 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:46,311 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:46,312 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:46,312 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:46,312 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:46,312 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:46,313 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:46,313 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:46,336 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:46,340 - INFO  [Thread-0:Configuration@1285] - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2022-05-18 01:47:46,340 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:46,340 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:46,342 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:46,342 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:46
2022-05-18 01:47:46,344 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:46,344 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:46,345 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:46,345 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:46,421 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:46,424 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:46,424 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:46,425 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:46,425 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:46,425 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:46,447 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:46,448 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:46,448 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:46,448 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:46,501 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:46,501 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:46,501 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:46,501 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:46,511 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:46,511 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:46,512 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:46,512 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:46,529 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:46,529 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:46,529 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:46,534 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:46,535 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:46,536 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:46,536 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:46,537 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:46,537 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:46,563 - INFO  [IPC Server handler 0 on 41483:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1
2022-05-18 01:47:46,563 - INFO  [IPC Server handler 3 on 39473:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1
2022-05-18 01:47:46,564 - WARN  [IPC Server handler 0 on 41483:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1 does not exist
2022-05-18 01:47:46,564 - WARN  [IPC Server handler 3 on 39473:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1 does not exist
2022-05-18 01:47:46,564 - INFO  [IPC Server handler 0 on 44035:JournalNode@96] - Initializing journal in directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1
2022-05-18 01:47:46,565 - WARN  [IPC Server handler 0 on 44035:Storage$StorageDirectory@600] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1 does not exist
2022-05-18 01:47:46,573 - INFO  [Thread-0:FSImage@164] - Allocated new BlockPoolId: BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:46,647 - INFO  [Thread-0:NNStorage@583] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1 has been successfully formatted.
2022-05-18 01:47:46,715 - INFO  [Thread-0:NNStorage@583] - Storage directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2 has been successfully formatted.
2022-05-18 01:47:46,742 - INFO  [IPC Server handler 1 on 41483:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@6c0a5510 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:46,742 - INFO  [IPC Server handler 1 on 44035:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@34b156f5 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:46,742 - INFO  [IPC Server handler 0 on 39473:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@71d3c053 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:46,743 - INFO  [IPC Server handler 1 on 44035:Storage$StorageDirectory@603] - /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1 does not exist. Creating ...
2022-05-18 01:47:46,743 - INFO  [IPC Server handler 1 on 41483:Storage$StorageDirectory@603] - /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1 does not exist. Creating ...
2022-05-18 01:47:46,743 - INFO  [IPC Server handler 0 on 39473:Storage$StorageDirectory@603] - /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1 does not exist. Creating ...
2022-05-18 01:47:46,783 - INFO  [IPC Server handler 1 on 44035:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,783 - INFO  [IPC Server handler 0 on 39473:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,783 - INFO  [IPC Server handler 1 on 41483:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,784 - INFO  [IPC Server handler 0 on 39473:JNStorage@217] - Formatting journal Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1 with nsid: 1202019126
2022-05-18 01:47:46,784 - INFO  [IPC Server handler 1 on 44035:JNStorage@217] - Formatting journal Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1 with nsid: 1202019126
2022-05-18 01:47:46,784 - INFO  [IPC Server handler 1 on 41483:JNStorage@217] - Formatting journal Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1 with nsid: 1202019126
2022-05-18 01:47:46,909 - INFO  [IPC Server handler 1 on 44035:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,909 - INFO  [IPC Server handler 0 on 39473:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,943 - INFO  [IPC Server handler 1 on 41483:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:46,955 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@429] - Saving image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 using no compression
2022-05-18 01:47:46,955 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@429] - Saving image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 using no compression
2022-05-18 01:47:47,063 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@432] - Image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 of size 333 bytes saved in 0 seconds.
2022-05-18 01:47:47,063 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@432] - Image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 of size 333 bytes saved in 0 seconds.
2022-05-18 01:47:47,105 - INFO  [Thread-0:NNStorageRetentionManager@203] - Going to retain 1 images with txid >= 0
2022-05-18 01:47:47,181 - INFO  [Thread-0:MiniDFSCluster@1227] - Copying namedir from primary node dir file:/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1 to file:/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3
2022-05-18 01:47:47,212 - INFO  [Thread-0:MiniDFSCluster@1227] - Copying namedir from primary node dir file:/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1 to file:/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4
2022-05-18 01:47:47,241 - INFO  [Thread-0:NameNode@1577] - createNameNode []
2022-05-18 01:47:47,252 - INFO  [Thread-0:MetricsSystemImpl@158] - NameNode metrics system started (again)
2022-05-18 01:47:47,254 - INFO  [Thread-0:NameNode@464] - fs.defaultFS is hdfs://ns1
2022-05-18 01:47:47,254 - INFO  [Thread-0:NameNode@484] - Clients are to use ns1 to access this namenode/service.
2022-05-18 01:47:47,282 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@28f23e9a:JvmPauseMonitor$Monitor@188] - Starting JVM pause monitor
2022-05-18 01:47:47,282 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for hdfs at: http://localhost:10053
2022-05-18 01:47:47,284 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:47,285 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.namenode is not defined
2022-05-18 01:47:47,285 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:47,286 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2022-05-18 01:47:47,286 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:47,290 - INFO  [Thread-0:NameNodeHttpServer@98] - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2022-05-18 01:47:47,291 - INFO  [Thread-0:HttpServer2@779] - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2022-05-18 01:47:47,294 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 10053
2022-05-18 01:47:47,294 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:47,297 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@b67ed31{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:47,430 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@27e6ceb2{/,file:///tmp/jetty-localhost-10053-hdfs-_-any-5310785316957174526.dir/webapp/,AVAILABLE}{/hdfs}
2022-05-18 01:47:47,431 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@74204fdc{HTTP/1.1,[http/1.1]}{localhost:10053}
2022-05-18 01:47:47,432 - INFO  [Thread-0:Server@414] - Started @6743ms
2022-05-18 01:47:47,435 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:47,435 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:47,435 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:47,436 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:47,437 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:47,437 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:47,437 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:47,437 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:47,438 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:47
2022-05-18 01:47:47,438 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:47,438 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:47,438 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:47,438 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:47,493 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:47,494 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:47,494 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:47,494 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:47,495 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:47,496 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:47,496 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:47,496 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:47,497 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:47,498 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:47,511 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:47,516 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:47,516 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:47,516 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:47,517 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:47,517 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:47,517 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:47,517 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:47,520 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:47,520 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:47,520 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:47,521 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:47,521 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:47,521 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:47,521 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:47,521 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:47,521 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:47,552 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:47,586 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:47,597 - INFO  [Thread-0:FSImage@712] - No edit log streams selected.
2022-05-18 01:47:47,597 - INFO  [Thread-0:FSImage@775] - Planning to load image: FSImageFile(file=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2022-05-18 01:47:47,610 - INFO  [Thread-0:FSImageFormatPBINode$Loader@266] - Loading 1 INodes.
2022-05-18 01:47:47,615 - INFO  [Thread-0:FSImageFormatProtobuf$Loader@185] - Loaded FSImage in 0 seconds.
2022-05-18 01:47:47,615 - INFO  [Thread-0:FSImage@941] - Loaded image for txid 0 from /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2022-05-18 01:47:47,620 - INFO  [Thread-0:FSNamesystem@1080] - Need to save fs image? false (staleImage=false, haEnabled=true, isRollingUpgrade=false)
2022-05-18 01:47:47,621 - INFO  [Thread-0:NameCache@143] - initialized with 0 entries 0 lookups
2022-05-18 01:47:47,621 - INFO  [Thread-0:FSNamesystem@714] - Finished loading FSImage in 98 msecs
2022-05-18 01:47:49,704 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@28f23e9a:JvmPauseMonitor$Monitor@205] - Detected pause in JVM or host machine (eg GC): pause of approximately 1918ms
GC pool 'PS MarkSweep' had collection(s): count=1 time=684ms
GC pool 'PS Scavenge' had collection(s): count=2 time=1284ms
2022-05-18 01:47:49,745 - INFO  [Thread-0:NameNodeRpcServer@439] - RPC server is binding to localhost:10052
2022-05-18 01:47:49,745 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:49,749 - INFO  [Socket Reader #1 for port 10052:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 10052
2022-05-18 01:47:49,763 - INFO  [Thread-0:FSNamesystem@4811] - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2022-05-18 01:47:49,778 - INFO  [Thread-0:LeaseManager@158] - Number of blocks under construction: 0
2022-05-18 01:47:49,791 - INFO  [Thread-0:BlockManagerSafeMode@396] - STATE* Leaving safe mode after 0 secs
2022-05-18 01:47:49,792 - INFO  [Thread-0:BlockManagerSafeMode@402] - STATE* Network topology has 0 racks and 0 datanodes
2022-05-18 01:47:49,792 - INFO  [Thread-0:BlockManagerSafeMode@404] - STATE* UnderReplicatedBlocks has 0 blocks
2022-05-18 01:47:49,812 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:49,812 - INFO  [IPC Server listener on 10052:Server$Listener@1146] - IPC Server listener on 10052: starting
2022-05-18 01:47:49,815 - INFO  [Thread-0:NameNode@830] - NameNode RPC up at: localhost/127.0.0.1:10052
2022-05-18 01:47:49,817 - INFO  [Thread-0:FSNamesystem@1354] - Starting services required for standby state
2022-05-18 01:47:49,820 - INFO  [Thread-0:EditLogTailer@169] - Will roll logs on active node every 120 seconds.
2022-05-18 01:47:49,820 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.ha.tail-edits.period(1) assuming SECONDS
2022-05-18 01:47:49,822 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.checkpoint.check.period(2) assuming SECONDS
2022-05-18 01:47:49,825 - INFO  [Thread-0:StandbyCheckpointer@138] - Starting standby checkpoint thread...
Checkpointing active NN to possible NNs: [http://127.0.0.1:10055]
Serving checkpoints at http://localhost:10053
2022-05-18 01:47:49,828 - INFO  [Thread-0:NameNode@1577] - createNameNode []
2022-05-18 01:47:49,828 - INFO  [Thread-0:MetricsSystemImpl@158] - NameNode metrics system started (again)
2022-05-18 01:47:49,829 - INFO  [Thread-0:NameNode@464] - fs.defaultFS is hdfs://ns1
2022-05-18 01:47:49,829 - INFO  [Thread-0:NameNode@484] - Clients are to use ns1 to access this namenode/service.
2022-05-18 01:47:49,834 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for hdfs at: http://localhost:10055
2022-05-18 01:47:49,834 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@fb8e401:JvmPauseMonitor$Monitor@188] - Starting JVM pause monitor
2022-05-18 01:47:49,836 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:49,837 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.namenode is not defined
2022-05-18 01:47:49,838 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:49,838 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2022-05-18 01:47:49,839 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:49,841 - INFO  [Thread-0:NameNodeHttpServer@98] - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2022-05-18 01:47:49,841 - INFO  [Thread-0:HttpServer2@779] - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2022-05-18 01:47:49,841 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 10055
2022-05-18 01:47:49,841 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:49,844 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@2f9f74a{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:49,946 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@2e297b4{/,file:///tmp/jetty-localhost-10055-hdfs-_-any-1715010725386625339.dir/webapp/,AVAILABLE}{/hdfs}
2022-05-18 01:47:49,947 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@646563ab{HTTP/1.1,[http/1.1]}{localhost:10055}
2022-05-18 01:47:49,947 - INFO  [Thread-0:Server@414] - Started @9259ms
2022-05-18 01:47:49,949 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:49,950 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:49,951 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:49,951 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:49,951 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:49,951 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:49,952 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:49
2022-05-18 01:47:49,952 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:49,952 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:49,952 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:49,952 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:50,031 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:50,031 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:50,031 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:50,031 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:50,032 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:50,033 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:50,033 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,033 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:50,033 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:50,070 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:50,070 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:50,070 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:50,070 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:50,070 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:50,070 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,071 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:50,071 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:50,081 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:50,081 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:50,081 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:50,081 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:50,081 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:50,081 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:50,081 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,081 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:50,081 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:50,118 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,152 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,162 - INFO  [Thread-0:FSImage@712] - No edit log streams selected.
2022-05-18 01:47:50,163 - INFO  [Thread-0:FSImage@775] - Planning to load image: FSImageFile(file=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2022-05-18 01:47:50,165 - INFO  [Thread-0:FSImageFormatPBINode$Loader@266] - Loading 1 INodes.
2022-05-18 01:47:50,166 - INFO  [Thread-0:FSImageFormatProtobuf$Loader@185] - Loaded FSImage in 0 seconds.
2022-05-18 01:47:50,167 - INFO  [Thread-0:FSImage@941] - Loaded image for txid 0 from /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage_0000000000000000000
2022-05-18 01:47:50,167 - INFO  [Thread-0:FSNamesystem@1080] - Need to save fs image? false (staleImage=false, haEnabled=true, isRollingUpgrade=false)
2022-05-18 01:47:50,167 - INFO  [Thread-0:NameCache@143] - initialized with 0 entries 0 lookups
2022-05-18 01:47:50,167 - INFO  [Thread-0:FSNamesystem@714] - Finished loading FSImage in 83 msecs
2022-05-18 01:47:50,168 - INFO  [Thread-0:NameNodeRpcServer@439] - RPC server is binding to localhost:10054
2022-05-18 01:47:50,168 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:50,169 - INFO  [Socket Reader #1 for port 10054:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 10054
2022-05-18 01:47:50,173 - INFO  [Thread-0:FSNamesystem@4811] - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2022-05-18 01:47:50,188 - INFO  [Thread-0:LeaseManager@158] - Number of blocks under construction: 0
2022-05-18 01:47:50,190 - INFO  [Thread-0:BlockManagerSafeMode@396] - STATE* Leaving safe mode after 0 secs
2022-05-18 01:47:50,190 - INFO  [Thread-0:BlockManagerSafeMode@402] - STATE* Network topology has 0 racks and 0 datanodes
2022-05-18 01:47:50,190 - INFO  [Thread-0:BlockManagerSafeMode@404] - STATE* UnderReplicatedBlocks has 0 blocks
2022-05-18 01:47:50,197 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:50,197 - INFO  [IPC Server listener on 10054:Server$Listener@1146] - IPC Server listener on 10054: starting
2022-05-18 01:47:50,200 - INFO  [Thread-0:NameNode@830] - NameNode RPC up at: localhost/127.0.0.1:10054
2022-05-18 01:47:50,200 - INFO  [Thread-0:FSNamesystem@1354] - Starting services required for standby state
2022-05-18 01:47:50,202 - INFO  [Thread-0:EditLogTailer@169] - Will roll logs on active node every 120 seconds.
2022-05-18 01:47:50,202 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.ha.tail-edits.period(1) assuming SECONDS
2022-05-18 01:47:50,202 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.checkpoint.check.period(2) assuming SECONDS
2022-05-18 01:47:50,203 - INFO  [Thread-0:StandbyCheckpointer@138] - Starting standby checkpoint thread...
Checkpointing active NN to possible NNs: [http://localhost:10053]
Serving checkpoints at http://localhost:10055
2022-05-18 01:47:50,471 - INFO  [Thread-0:MiniDFSCluster@2621] - Cluster is active
2022-05-18 01:47:50,482 - INFO  [Thread-0:MiniDFSCluster@2621] - Cluster is active
2022-05-18 01:47:50,482 - INFO  [Thread-0:MiniDFSCluster@2038] - Shutting down the namenode
2022-05-18 01:47:50,482 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:47:50,483 - WARN  [Edit log tailer:EditLogTailer$EditLogTailerThread@447] - Edit log tailer interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.doWork(EditLogTailer.java:445)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.access$400(EditLogTailer.java:380)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread$1.run(EditLogTailer.java:397)
	at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:481)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.run(EditLogTailer.java:393)
2022-05-18 01:47:50,487 - INFO  [Thread-0:Server@3074] - Stopping server on 10052
2022-05-18 01:47:50,490 - INFO  [IPC Server listener on 10052:Server$Listener@1178] - Stopping IPC Server listener on 10052
2022-05-18 01:47:50,491 - INFO  [StorageInfoMonitor:BlockManager$StorageInfoDefragmenter@4450] - Stopping thread.
2022-05-18 01:47:50,491 - INFO  [RedundancyMonitor:BlockManager$RedundancyMonitor@4415] - Stopping RedundancyMonitor.
2022-05-18 01:47:50,491 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:47:50,567 - INFO  [Thread-0:FSNamesystem@1301] - Stopping services started for active state
2022-05-18 01:47:50,568 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:47:50,570 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@27e6ceb2{/,null,UNAVAILABLE}{/hdfs}
2022-05-18 01:47:50,575 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@74204fdc{HTTP/1.1,[http/1.1]}{localhost:10053}
2022-05-18 01:47:50,575 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@b67ed31{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:47:50,601 - INFO  [Thread-0:MiniDFSCluster@2038] - Shutting down the namenode
2022-05-18 01:47:50,601 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:47:50,601 - WARN  [Edit log tailer:EditLogTailer$EditLogTailerThread@447] - Edit log tailer interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.doWork(EditLogTailer.java:445)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.access$400(EditLogTailer.java:380)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread$1.run(EditLogTailer.java:397)
	at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:481)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.run(EditLogTailer.java:393)
2022-05-18 01:47:50,602 - INFO  [Thread-0:Server@3074] - Stopping server on 10054
2022-05-18 01:47:50,605 - INFO  [IPC Server listener on 10054:Server$Listener@1178] - Stopping IPC Server listener on 10054
2022-05-18 01:47:50,606 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:47:50,606 - INFO  [RedundancyMonitor:BlockManager$RedundancyMonitor@4415] - Stopping RedundancyMonitor.
2022-05-18 01:47:50,606 - INFO  [StorageInfoMonitor:BlockManager$StorageInfoDefragmenter@4450] - Stopping thread.
2022-05-18 01:47:50,654 - INFO  [Thread-0:FSNamesystem@1301] - Stopping services started for active state
2022-05-18 01:47:50,655 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:47:50,657 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@2e297b4{/,null,UNAVAILABLE}{/hdfs}
2022-05-18 01:47:50,658 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@646563ab{HTTP/1.1,[http/1.1]}{localhost:10055}
2022-05-18 01:47:50,658 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@2f9f74a{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:47:50,680 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:50,681 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:50,682 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:50,682 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:50,682 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:50,682 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:50,682 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:50,683 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:50,683 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:50
2022-05-18 01:47:50,683 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:50,683 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,684 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:50,684 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:50,763 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:50,763 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:50,763 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:50,763 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:50,763 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:50,764 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:50,764 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:50,764 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,764 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:50,765 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:50,805 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:50,805 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:50,805 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:50,805 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:50,805 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:50,805 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,806 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:50,806 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:50,815 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:50,816 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:50,816 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:50,816 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:50,816 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:50,816 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:50,816 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:50,816 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:50,816 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:50,860 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,893 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,895 - INFO  [Thread-0:FSImage@712] - No edit log streams selected.
2022-05-18 01:47:50,895 - INFO  [Thread-0:FSImage@775] - Planning to load image: FSImageFile(file=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2022-05-18 01:47:50,897 - INFO  [Thread-0:FSImageFormatPBINode$Loader@266] - Loading 1 INodes.
2022-05-18 01:47:50,897 - INFO  [Thread-0:FSImageFormatProtobuf$Loader@185] - Loaded FSImage in 0 seconds.
2022-05-18 01:47:50,897 - INFO  [Thread-0:FSImage@941] - Loaded image for txid 0 from /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2022-05-18 01:47:50,898 - INFO  [Thread-0:FSNamesystem@1080] - Need to save fs image? false (staleImage=false, haEnabled=true, isRollingUpgrade=false)
2022-05-18 01:47:50,898 - INFO  [Thread-0:NameCache@143] - initialized with 0 entries 0 lookups
2022-05-18 01:47:50,898 - INFO  [Thread-0:FSNamesystem@714] - Finished loading FSImage in 79 msecs
2022-05-18 01:47:50,898 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
Data exists in QJM to [127.0.0.1:39473, 127.0.0.1:44035, 127.0.0.1:41483]. Formatting anyway.
2022-05-18 01:47:50,912 - INFO  [IPC Server handler 4 on 44035:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@34b156f5 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:50,912 - INFO  [IPC Server handler 4 on 41483:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@6c0a5510 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:50,912 - INFO  [IPC Server handler 1 on 39473:Journal@220] - Formatting org.apache.hadoop.hdfs.qjournal.server.Journal@71d3c053 with namespace info: lv=-64;cid=testClusterID;nsid=1202019126;c=1652852866573;bpid=BP-1022481881-10.0.0.206-1652852866573
2022-05-18 01:47:50,951 - INFO  [IPC Server handler 1 on 39473:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,952 - INFO  [IPC Server handler 4 on 41483:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,951 - INFO  [IPC Server handler 4 on 44035:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:50,953 - INFO  [IPC Server handler 4 on 41483:Server@2719] - IPC Server handler 4 on 41483, call Call#39 Retry#0 org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocol.format from 127.0.0.1:53198
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)
2022-05-18 01:47:50,953 - INFO  [IPC Server handler 1 on 39473:Server@2719] - IPC Server handler 1 on 39473, call Call#38 Retry#0 org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocol.format from 127.0.0.1:43248
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)
2022-05-18 01:47:50,953 - INFO  [IPC Server handler 4 on 44035:Server@2719] - IPC Server handler 4 on 44035, call Call#37 Retry#0 org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocol.format from 127.0.0.1:33956
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)
2022-05-18 01:47:50,957 - ERROR [Thread-0:NameNode@1267] - Could not initialize shared edits dir
org.apache.hadoop.hdfs.qjournal.client.QuorumException: Could not format one or more JournalNodes. 3 exceptions thrown:
127.0.0.1:39473: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)

127.0.0.1:44035: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)

127.0.0.1:41483: Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1 is in an inconsistent state: Can't format the storage directory because the current directory is not empty.
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.checkEmptyCurrent(Storage.java:553)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.analyzeStorage(Storage.java:629)
	at org.apache.hadoop.hdfs.qjournal.server.JNStorage.format(JNStorage.java:211)
	at org.apache.hadoop.hdfs.qjournal.server.Journal.format(Journal.java:222)
	at org.apache.hadoop.hdfs.qjournal.server.JournalNodeRpcServer.format(JournalNodeRpcServer.java:146)
	at org.apache.hadoop.hdfs.qjournal.protocolPB.QJournalProtocolServerSideTranslatorPB.format(QJournalProtocolServerSideTranslatorPB.java:145)
	at org.apache.hadoop.hdfs.qjournal.protocol.QJournalProtocolProtos$QJournalProtocolService$2.callBlockingMethod(QJournalProtocolProtos.java:25419)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:869)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:815)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1962)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2675)

	at org.apache.hadoop.hdfs.qjournal.client.QuorumException.create(QuorumException.java:81)
	at org.apache.hadoop.hdfs.qjournal.client.QuorumCall.rethrowException(QuorumCall.java:247)
	at org.apache.hadoop.hdfs.qjournal.client.QuorumJournalManager.format(QuorumJournalManager.java:213)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.formatNonFileJournals(FSEditLog.java:422)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initializeSharedEdits(NameNode.java:1256)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initializeSharedEdits(NameNode.java:1181)
	at org.apache.hadoop.hdfs.qjournal.MiniQJMHACluster.<init>(MiniQJMHACluster.java:121)
	at org.apache.hadoop.hdfs.qjournal.MiniQJMHACluster.<init>(MiniQJMHACluster.java:37)
	at org.apache.hadoop.hdfs.qjournal.MiniQJMHACluster$Builder.build(MiniQJMHACluster.java:64)
	at org.apache.hadoop.hdfs.TestRollingUpgrade.testRollBackImage(TestRollingUpgrade.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)
2022-05-18 01:47:50,958 - INFO  [Thread-0:NameNode@1577] - createNameNode []
2022-05-18 01:47:50,958 - INFO  [Thread-0:MetricsSystemImpl@158] - NameNode metrics system started (again)
2022-05-18 01:47:50,959 - INFO  [Thread-0:NameNode@464] - fs.defaultFS is hdfs://localhost:10052
2022-05-18 01:47:50,959 - INFO  [Thread-0:NameNode@484] - Clients are to use localhost:10052 to access this namenode/service.
2022-05-18 01:47:50,965 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@35fa5fcf:JvmPauseMonitor$Monitor@188] - Starting JVM pause monitor
2022-05-18 01:47:50,965 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for hdfs at: http://localhost:10053
2022-05-18 01:47:50,967 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:50,968 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.namenode is not defined
2022-05-18 01:47:50,968 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:50,969 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2022-05-18 01:47:50,969 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:50,970 - INFO  [Thread-0:NameNodeHttpServer@98] - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2022-05-18 01:47:50,970 - INFO  [Thread-0:HttpServer2@779] - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2022-05-18 01:47:50,970 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 10053
2022-05-18 01:47:50,970 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:50,972 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@2d2c20fe{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:51,063 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@19e3213d{/,file:///tmp/jetty-localhost-10053-hdfs-_-any-5425104986425035529.dir/webapp/,AVAILABLE}{/hdfs}
2022-05-18 01:47:51,064 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@380265ba{HTTP/1.1,[http/1.1]}{localhost:10053}
2022-05-18 01:47:51,064 - INFO  [Thread-0:Server@414] - Started @10375ms
2022-05-18 01:47:51,065 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:51,066 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:51,067 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:51,067 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:51,067 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:51,067 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:51,067 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:51
2022-05-18 01:47:51,067 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:51,067 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:51,068 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:51,068 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:51,722 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:51,725 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:51,725 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:51,726 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:51,726 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:51,726 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:51,726 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:51,739 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:51,739 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:51,739 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:51,739 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:51,739 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:51,739 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:51,740 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:51,740 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:51,743 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:51,743 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:51,743 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:51,743 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:51,743 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:51,743 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:51,743 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:51,744 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:51,744 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:51,784 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:51,818 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:51,824 - INFO  [Thread-0:FSImage@712] - No edit log streams selected.
2022-05-18 01:47:51,824 - INFO  [Thread-0:FSImage@775] - Planning to load image: FSImageFile(file=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2022-05-18 01:47:51,825 - INFO  [Thread-0:FSImageFormatPBINode$Loader@266] - Loading 1 INodes.
2022-05-18 01:47:51,826 - INFO  [Thread-0:FSImageFormatProtobuf$Loader@185] - Loaded FSImage in 0 seconds.
2022-05-18 01:47:51,826 - INFO  [Thread-0:FSImage@941] - Loaded image for txid 0 from /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2022-05-18 01:47:51,826 - INFO  [Thread-0:FSNamesystem@1080] - Need to save fs image? false (staleImage=false, haEnabled=true, isRollingUpgrade=false)
2022-05-18 01:47:51,826 - INFO  [Thread-0:NameCache@143] - initialized with 0 entries 0 lookups
2022-05-18 01:47:51,826 - INFO  [Thread-0:FSNamesystem@714] - Finished loading FSImage in 81 msecs
2022-05-18 01:47:51,827 - INFO  [Thread-0:NameNodeRpcServer@439] - RPC server is binding to localhost:10052
2022-05-18 01:47:51,827 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:51,828 - INFO  [Socket Reader #1 for port 10052:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 10052
2022-05-18 01:47:51,832 - INFO  [Thread-0:FSNamesystem@4811] - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2022-05-18 01:47:51,844 - INFO  [Thread-0:LeaseManager@158] - Number of blocks under construction: 0
2022-05-18 01:47:51,846 - INFO  [Thread-0:BlockManagerSafeMode@396] - STATE* Leaving safe mode after 0 secs
2022-05-18 01:47:51,846 - INFO  [Thread-0:BlockManagerSafeMode@402] - STATE* Network topology has 0 racks and 0 datanodes
2022-05-18 01:47:51,846 - INFO  [Thread-0:BlockManagerSafeMode@404] - STATE* UnderReplicatedBlocks has 0 blocks
2022-05-18 01:47:51,852 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:51,852 - INFO  [IPC Server listener on 10052:Server$Listener@1146] - IPC Server listener on 10052: starting
2022-05-18 01:47:51,854 - INFO  [Thread-0:NameNode@830] - NameNode RPC up at: localhost/127.0.0.1:10052
2022-05-18 01:47:51,854 - INFO  [Thread-0:FSNamesystem@1354] - Starting services required for standby state
2022-05-18 01:47:51,855 - INFO  [Thread-0:EditLogTailer@169] - Will roll logs on active node every 120 seconds.
2022-05-18 01:47:51,855 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.ha.tail-edits.period(1) assuming SECONDS
2022-05-18 01:47:51,855 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.checkpoint.check.period(2) assuming SECONDS
2022-05-18 01:47:51,856 - INFO  [Thread-0:StandbyCheckpointer@138] - Starting standby checkpoint thread...
Checkpointing active NN to possible NNs: [http://localhost:10055]
Serving checkpoints at http://localhost:10053
2022-05-18 01:47:51,857 - INFO  [Thread-0:NameNode@1577] - createNameNode []
2022-05-18 01:47:51,857 - INFO  [Thread-0:MetricsSystemImpl@158] - NameNode metrics system started (again)
2022-05-18 01:47:51,857 - INFO  [Thread-0:NameNode@464] - fs.defaultFS is hdfs://localhost:10054
2022-05-18 01:47:51,857 - INFO  [Thread-0:NameNode@484] - Clients are to use localhost:10054 to access this namenode/service.
2022-05-18 01:47:51,861 - INFO  [Thread-0:DFSUtil@1512] - Starting Web-server for hdfs at: http://localhost:10055
2022-05-18 01:47:51,861 - INFO  [org.apache.hadoop.util.JvmPauseMonitor$Monitor@21dc5293:JvmPauseMonitor$Monitor@188] - Starting JVM pause monitor
2022-05-18 01:47:51,862 - INFO  [Thread-0:AuthenticationFilter@240] - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-05-18 01:47:51,863 - INFO  [Thread-0:HttpRequestLog@81] - Http request log for http.requests.namenode is not defined
2022-05-18 01:47:51,863 - INFO  [Thread-0:HttpServer2@921] - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2022-05-18 01:47:51,864 - INFO  [Thread-0:HttpServer2@894] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2022-05-18 01:47:51,864 - INFO  [Thread-0:HttpServer2@904] - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-05-18 01:47:51,865 - INFO  [Thread-0:NameNodeHttpServer@98] - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2022-05-18 01:47:51,865 - INFO  [Thread-0:HttpServer2@779] - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2022-05-18 01:47:51,865 - INFO  [Thread-0:HttpServer2@1121] - Jetty bound to port 10055
2022-05-18 01:47:51,865 - INFO  [Thread-0:Server@346] - jetty-9.3.19.v20170502
2022-05-18 01:47:51,867 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.s.ServletContextHandler@7bc8998b{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,AVAILABLE}
2022-05-18 01:47:51,992 - INFO  [Thread-0:ContextHandler@781] - Started o.e.j.w.WebAppContext@74a28385{/,file:///tmp/jetty-localhost-10055-hdfs-_-any-1734009640151033685.dir/webapp/,AVAILABLE}{/hdfs}
2022-05-18 01:47:51,993 - INFO  [Thread-0:AbstractConnector@278] - Started ServerConnector@734320d8{HTTP/1.1,[http/1.1]}{localhost:10055}
2022-05-18 01:47:51,993 - INFO  [Thread-0:Server@414] - Started @11304ms
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSEditLog@224] - Edit logging is async:false
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystem@742] - KeyProvider: null
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystemLock@120] - fsLock is fair: true
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystemLock@136] - Detailed lock hold time metrics enabled: false
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystem@763] - fsOwner             = haoze (auth:SIMPLE)
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystem@764] - supergroup          = supergroup
2022-05-18 01:47:51,995 - INFO  [Thread-0:FSNamesystem@765] - isPermissionEnabled = true
2022-05-18 01:47:51,996 - INFO  [Thread-0:FSNamesystem@774] - Determined nameservice ID: ns1
2022-05-18 01:47:51,996 - INFO  [Thread-0:FSNamesystem@776] - HA Enabled: true
2022-05-18 01:47:51,996 - INFO  [Thread-0:Util@395] - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2022-05-18 01:47:51,996 - INFO  [Thread-0:DatanodeManager@301] - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2022-05-18 01:47:51,996 - INFO  [Thread-0:DatanodeManager@309] - dfs.namenode.datanode.registration.ip-hostname-check=true
2022-05-18 01:47:51,997 - INFO  [Thread-0:InvalidateBlocks@76] - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2022-05-18 01:47:51,998 - INFO  [Thread-0:InvalidateBlocks@82] - The block deletion will start around 2022 May 18 01:47:51
2022-05-18 01:47:51,998 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map BlocksMap
2022-05-18 01:47:51,998 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:51,998 - INFO  [Thread-0:LightWeightGSet@397] - 2.0% max memory 13.9 GB = 285.3 MB
2022-05-18 01:47:51,998 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^25 = 33554432 entries
2022-05-18 01:47:52,046 - INFO  [Thread-0:BlockManager@560] - dfs.block.access.token.enable = false
2022-05-18 01:47:52,046 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2022-05-18 01:47:52,046 - INFO  [Thread-0:BlockManagerSafeMode@161] - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManagerSafeMode@162] - dfs.namenode.safemode.min.datanodes = 0
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManagerSafeMode@164] - dfs.namenode.safemode.extension = 0
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@546] - defaultReplication         = 0
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@547] - maxReplication             = 512
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@548] - minReplication             = 1
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@549] - maxReplicationStreams      = 2
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@550] - redundancyRecheckInterval  = 3000ms
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@551] - encryptDataTransfer        = false
2022-05-18 01:47:52,047 - INFO  [Thread-0:BlockManager@552] - maxNumBlocksToLog          = 1000
2022-05-18 01:47:52,047 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map INodeMap
2022-05-18 01:47:52,048 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:52,048 - INFO  [Thread-0:LightWeightGSet@397] - 1.0% max memory 13.9 GB = 142.7 MB
2022-05-18 01:47:52,048 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^24 = 16777216 entries
2022-05-18 01:47:52,062 - INFO  [Thread-0:FSDirectory@278] - ACLs enabled? false
2022-05-18 01:47:52,062 - INFO  [Thread-0:FSDirectory@282] - POSIX ACL inheritance enabled? true
2022-05-18 01:47:52,062 - INFO  [Thread-0:FSDirectory@286] - XAttrs enabled? true
2022-05-18 01:47:52,062 - INFO  [Thread-0:FSDirectory@350] - Caching file names occurring more than 10 times
2022-05-18 01:47:52,062 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map cachedBlocks
2022-05-18 01:47:52,062 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:52,063 - INFO  [Thread-0:LightWeightGSet@397] - 0.25% max memory 13.9 GB = 35.7 MB
2022-05-18 01:47:52,063 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^22 = 4194304 entries
2022-05-18 01:47:52,066 - INFO  [Thread-0:TopMetrics@76] - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2022-05-18 01:47:52,066 - INFO  [Thread-0:TopMetrics@78] - NNTop conf: dfs.namenode.top.num.users = 10
2022-05-18 01:47:52,067 - INFO  [Thread-0:TopMetrics@80] - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2022-05-18 01:47:52,067 - INFO  [Thread-0:FSNamesystem@968] - Retry cache on namenode is enabled
2022-05-18 01:47:52,067 - INFO  [Thread-0:FSNamesystem@976] - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2022-05-18 01:47:52,067 - INFO  [Thread-0:LightWeightGSet@395] - Computing capacity for map NameNodeRetryCache
2022-05-18 01:47:52,067 - INFO  [Thread-0:LightWeightGSet@396] - VM type       = 64-bit
2022-05-18 01:47:52,067 - INFO  [Thread-0:LightWeightGSet@397] - 0.029999999329447746% max memory 13.9 GB = 4.3 MB
2022-05-18 01:47:52,067 - INFO  [Thread-0:LightWeightGSet@402] - capacity      = 2^19 = 524288 entries
2022-05-18 01:47:52,101 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:52,135 - INFO  [Thread-0:Storage$StorageDirectory@847] - Lock on /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4/in_use.lock acquired by nodename 4393@razor6
2022-05-18 01:47:52,144 - INFO  [Thread-0:FSImage@712] - No edit log streams selected.
2022-05-18 01:47:52,144 - INFO  [Thread-0:FSImage@775] - Planning to load image: FSImageFile(file=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2022-05-18 01:47:52,145 - INFO  [Thread-0:FSImageFormatPBINode$Loader@266] - Loading 1 INodes.
2022-05-18 01:47:52,145 - INFO  [Thread-0:FSImageFormatProtobuf$Loader@185] - Loaded FSImage in 0 seconds.
2022-05-18 01:47:52,146 - INFO  [Thread-0:FSImage@941] - Loaded image for txid 0 from /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage_0000000000000000000
2022-05-18 01:47:52,146 - INFO  [Thread-0:FSNamesystem@1080] - Need to save fs image? false (staleImage=false, haEnabled=true, isRollingUpgrade=false)
2022-05-18 01:47:52,146 - INFO  [Thread-0:NameCache@143] - initialized with 0 entries 0 lookups
2022-05-18 01:47:52,146 - INFO  [Thread-0:FSNamesystem@714] - Finished loading FSImage in 78 msecs
2022-05-18 01:47:52,146 - INFO  [Thread-0:NameNodeRpcServer@439] - RPC server is binding to localhost:10054
2022-05-18 01:47:52,147 - INFO  [Thread-0:CallQueueManager@84] - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2022-05-18 01:47:52,148 - INFO  [Socket Reader #1 for port 10054:Server$Listener$Reader@1067] - Starting Socket Reader #1 for port 10054
2022-05-18 01:47:52,151 - INFO  [Thread-0:FSNamesystem@4811] - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2022-05-18 01:47:52,167 - INFO  [Thread-0:LeaseManager@158] - Number of blocks under construction: 0
2022-05-18 01:47:52,169 - INFO  [Thread-0:BlockManagerSafeMode@396] - STATE* Leaving safe mode after 0 secs
2022-05-18 01:47:52,169 - INFO  [Thread-0:BlockManagerSafeMode@402] - STATE* Network topology has 0 racks and 0 datanodes
2022-05-18 01:47:52,170 - INFO  [Thread-0:BlockManagerSafeMode@404] - STATE* UnderReplicatedBlocks has 0 blocks
2022-05-18 01:47:52,174 - INFO  [IPC Server Responder:Server$Responder@1307] - IPC Server Responder: starting
2022-05-18 01:47:52,174 - INFO  [IPC Server listener on 10054:Server$Listener@1146] - IPC Server listener on 10054: starting
2022-05-18 01:47:52,177 - INFO  [Thread-0:NameNode@830] - NameNode RPC up at: localhost/127.0.0.1:10054
2022-05-18 01:47:52,177 - INFO  [Thread-0:FSNamesystem@1354] - Starting services required for standby state
2022-05-18 01:47:52,179 - INFO  [Thread-0:EditLogTailer@169] - Will roll logs on active node every 120 seconds.
2022-05-18 01:47:52,179 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.ha.tail-edits.period(1) assuming SECONDS
2022-05-18 01:47:52,179 - INFO  [Thread-0:Configuration@1285] - No unit for dfs.namenode.checkpoint.check.period(2) assuming SECONDS
2022-05-18 01:47:52,181 - INFO  [Thread-0:StandbyCheckpointer@138] - Starting standby checkpoint thread...
Checkpointing active NN to possible NNs: [http://localhost:10053]
Serving checkpoints at http://localhost:10055
2022-05-18 01:47:52,198 - INFO  [Thread-0:MiniDFSCluster@2621] - Cluster is active
2022-05-18 01:47:52,202 - INFO  [Thread-0:MiniDFSCluster@2621] - Cluster is active
2022-05-18 01:47:52,203 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:47:52,203 - WARN  [Edit log tailer:EditLogTailer$EditLogTailerThread@447] - Edit log tailer interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.doWork(EditLogTailer.java:445)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.access$400(EditLogTailer.java:380)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread$1.run(EditLogTailer.java:397)
	at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:481)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.run(EditLogTailer.java:393)
2022-05-18 01:47:52,204 - INFO  [Thread-0:FSNamesystem@1192] - Starting services required for active state
2022-05-18 01:47:52,206 - INFO  [Thread-0:QuorumJournalManager@417] - Starting recovery process for unclosed journal segments...
2022-05-18 01:47:52,219 - INFO  [IPC Server handler 0 on 41483:Journal@332] - Updating lastPromisedEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,219 - INFO  [IPC Server handler 0 on 44035:Journal@332] - Updating lastPromisedEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,219 - INFO  [IPC Server handler 3 on 39473:Journal@332] - Updating lastPromisedEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,262 - INFO  [IPC Server handler 3 on 39473:Journal@192] - Scanning storage FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1)
2022-05-18 01:47:52,262 - INFO  [IPC Server handler 0 on 44035:Journal@192] - Scanning storage FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1)
2022-05-18 01:47:52,262 - INFO  [IPC Server handler 0 on 41483:Journal@192] - Scanning storage FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1)
2022-05-18 01:47:52,263 - INFO  [IPC Server handler 3 on 39473:Journal@209] - No files in FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1)
2022-05-18 01:47:52,263 - INFO  [IPC Server handler 0 on 44035:Journal@209] - No files in FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1)
2022-05-18 01:47:52,263 - INFO  [IPC Server handler 0 on 41483:Journal@209] - No files in FileJournalManager(root=/home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1)
2022-05-18 01:47:52,264 - INFO  [Thread-0:QuorumJournalManager@419] - Successfully started new epoch 1
2022-05-18 01:47:52,265 - INFO  [Thread-0:FileJournalManager@396] - Recovering unfinalized segments in /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current
2022-05-18 01:47:52,265 - INFO  [Thread-0:FileJournalManager@396] - Recovering unfinalized segments in /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current
2022-05-18 01:47:52,265 - INFO  [Thread-0:FSNamesystem@1203] - Catching up to latest edits from old active before taking over writer role in edits logs
2022-05-18 01:47:52,270 - INFO  [Thread-0:DatanodeManager@1835] - Marking all datandoes as stale
2022-05-18 01:47:52,271 - INFO  [Thread-0:FSNamesystem@1214] - Reprocessing replication and invalidation queues
2022-05-18 01:47:52,271 - INFO  [Thread-0:BlockManager@4646] - initializing replication queues
2022-05-18 01:47:52,271 - INFO  [Thread-0:FSNamesystem@1225] - Will take over writing edit logs at txnid 1
2022-05-18 01:47:52,302 - INFO  [Thread-0:FSEditLog@1324] - Starting log segment at 1
2022-05-18 01:47:52,308 - INFO  [IPC Server handler 2 on 39473:Journal@561] - Updating lastWriterEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,308 - INFO  [IPC Server handler 2 on 41483:Journal@561] - Updating lastWriterEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,308 - INFO  [IPC Server handler 3 on 44035:Journal@561] - Updating lastWriterEpoch from 0 to 1 for client /127.0.0.1
2022-05-18 01:47:52,376 - INFO  [Thread-0:FSDirectory@706] - Initializing quota with 4 thread(s)
2022-05-18 01:47:52,380 - INFO  [Thread-0:FSDirectory@715] - Quota initialization completed in 3 milliseconds
name space=1
storage space=0
storage types=RAM_DISK=0, SSD=0, DISK=0, ARCHIVE=0
2022-05-18 01:47:52,384 - INFO  [CacheReplicationMonitor(1682750226):CacheReplicationMonitor@160] - Starting CacheReplicationMonitor with interval 30000 milliseconds
2022-05-18 01:47:52,384 - INFO  [Reconstruction Queue Initializer:BlockManager@3355] - Total number of blocks            = 0
2022-05-18 01:47:52,384 - INFO  [Reconstruction Queue Initializer:BlockManager@3356] - Number of invalid blocks          = 0
2022-05-18 01:47:52,384 - INFO  [Reconstruction Queue Initializer:BlockManager@3357] - Number of under-replicated blocks = 0
2022-05-18 01:47:52,384 - INFO  [Reconstruction Queue Initializer:BlockManager@3358] - Number of  over-replicated blocks = 0
2022-05-18 01:47:52,384 - INFO  [Reconstruction Queue Initializer:BlockManager@3360] - Number of blocks being written    = 0
2022-05-18 01:47:52,385 - INFO  [Reconstruction Queue Initializer:BlockManager@3363] - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 113 msec
2022-05-18 01:47:52,472 - INFO  [Thread-0:FSEditLog@1277] - Rolling edit logs
2022-05-18 01:47:52,472 - INFO  [Thread-0:FSEditLog@1369] - Ending log segment 1, 12
2022-05-18 01:47:52,473 - INFO  [Thread-0:FSEditLog@600] - logSyncAll toSyncToTxId=13 lastSyncedTxid=12 mostRecentTxid=13
2022-05-18 01:47:52,474 - INFO  [Thread-0:FSEditLog@605] - Done logSyncAll lastWrittenTxId=13 lastSyncedTxid=13 mostRecentTxid=13
2022-05-18 01:47:52,475 - INFO  [Thread-0:FSEditLog@770] - Number of transactions: 13 Total time for transactions(ms): 18 Number of transactions batched in Syncs: 0 Number of syncs: 13 SyncTimes(ms): 32 2 3 
2022-05-18 01:47:52,481 - INFO  [IPC Server handler 2 on 44035:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_inprogress_0000000000000000001 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_0000000000000000001-0000000000000000013
2022-05-18 01:47:52,481 - INFO  [IPC Server handler 3 on 41483:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_inprogress_0000000000000000001 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_0000000000000000001-0000000000000000013
2022-05-18 01:47:52,481 - INFO  [IPC Server handler 4 on 39473:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_inprogress_0000000000000000001 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_0000000000000000001-0000000000000000013
2022-05-18 01:47:52,485 - INFO  [Thread-0:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000001 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_0000000000000000001-0000000000000000013
2022-05-18 01:47:52,485 - INFO  [Thread-0:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000001 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_0000000000000000001-0000000000000000013
2022-05-18 01:47:52,486 - INFO  [Thread-0:FSEditLog@1324] - Starting log segment at 14
2022-05-18 01:47:52,558 - INFO  [IPC Server handler 2 on 10052:NameNodeRpcServer@1302] - rollingUpgrade PREPARE
2022-05-18 01:47:52,560 - INFO  [IPC Server handler 2 on 10052:FSEditLog@1277] - Rolling edit logs
2022-05-18 01:47:52,561 - INFO  [IPC Server handler 2 on 10052:FSEditLog@1369] - Ending log segment 14, 15
2022-05-18 01:47:52,561 - INFO  [IPC Server handler 2 on 10052:FSEditLog@600] - logSyncAll toSyncToTxId=16 lastSyncedTxid=14 mostRecentTxid=16
2022-05-18 01:47:52,565 - INFO  [IPC Server handler 2 on 10052:FSEditLog@605] - Done logSyncAll lastWrittenTxId=16 lastSyncedTxid=16 mostRecentTxid=16
2022-05-18 01:47:52,566 - INFO  [IPC Server handler 2 on 10052:FSEditLog@770] - Number of transactions: 3 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 1 Number of syncs: 2 SyncTimes(ms): 8 1 2 
2022-05-18 01:47:52,567 - INFO  [IPC Server handler 4 on 44035:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_inprogress_0000000000000000014 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_0000000000000000014-0000000000000000016
2022-05-18 01:47:52,567 - INFO  [IPC Server handler 1 on 39473:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_inprogress_0000000000000000014 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_0000000000000000014-0000000000000000016
2022-05-18 01:47:52,567 - INFO  [IPC Server handler 4 on 41483:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_inprogress_0000000000000000014 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_0000000000000000014-0000000000000000016
2022-05-18 01:47:52,570 - INFO  [IPC Server handler 2 on 10052:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000014 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_0000000000000000014-0000000000000000016
2022-05-18 01:47:52,571 - INFO  [IPC Server handler 2 on 10052:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000014 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_0000000000000000014-0000000000000000016
2022-05-18 01:47:52,571 - INFO  [IPC Server handler 2 on 10052:FSEditLog@1324] - Starting log segment at 17
2022-05-18 01:47:52,653 - INFO  [IPC Server handler 3 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:53,204 - INFO  [Edit log tailer:FSImage@879] - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@120cd9a0 expecting start txid #1
2022-05-18 01:47:53,205 - INFO  [Edit log tailer:FSEditLogLoader@149] - Start loading edits file http://localhost:43719/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:45963/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true
2022-05-18 01:47:53,205 - INFO  [Edit log tailer:RedundantEditLogInputStream@177] - Fast-forwarding stream 'http://localhost:43719/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:45963/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true' to transaction ID 1
2022-05-18 01:47:53,206 - INFO  [Edit log tailer:RedundantEditLogInputStream@177] - Fast-forwarding stream 'http://localhost:43719/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true' to transaction ID 1
2022-05-18 01:47:53,310 - INFO  [qtp1110616463-83:TransferFsImage@396] - Sending fileName: /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_0000000000000000001-0000000000000000013, fileSize: 835. Sent total: 835 bytes. Size of last segment intended to send: -1 bytes.
2022-05-18 01:47:53,322 - INFO  [Edit log tailer:FSEditLogLoader@152] - Edits file http://localhost:43719/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:45963/getJournal?jid=ns1&segmentTxId=1&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true of size 835 edits # 13 loaded in 0 seconds
2022-05-18 01:47:53,322 - INFO  [Edit log tailer:FSImage@879] - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@1ccb3591 expecting start txid #14
2022-05-18 01:47:53,322 - INFO  [Edit log tailer:FSEditLogLoader@149] - Start loading edits file http://localhost:45963/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:43719/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true
2022-05-18 01:47:53,323 - INFO  [Edit log tailer:RedundantEditLogInputStream@177] - Fast-forwarding stream 'http://localhost:45963/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:43719/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true' to transaction ID 1
2022-05-18 01:47:53,323 - INFO  [Edit log tailer:RedundantEditLogInputStream@177] - Fast-forwarding stream 'http://localhost:45963/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true' to transaction ID 1
2022-05-18 01:47:53,328 - INFO  [qtp1286706835-61:TransferFsImage@396] - Sending fileName: /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_0000000000000000014-0000000000000000016, fileSize: 67. Sent total: 67 bytes. Size of last segment intended to send: -1 bytes.
2022-05-18 01:47:53,329 - INFO  [Edit log tailer:FSEditLogLoader@152] - Edits file http://localhost:45963/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:43719/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true, http://localhost:42935/getJournal?jid=ns1&segmentTxId=14&storageInfo=-64%3A1202019126%3A1652852866573%3AtestClusterID&inProgressOk=true of size 67 edits # 3 loaded in 0 seconds
2022-05-18 01:47:53,329 - INFO  [Standby State Checkpointer:StandbyCheckpointer$CheckpointerThread@404] - Triggering checkpoint because there have been 13 txns since the last checkpoint, which exceeds the configured threshold 10
2022-05-18 01:47:53,331 - INFO  [Standby State Checkpointer:FSImage@1085] - Save namespace ...
2022-05-18 01:47:53,332 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@429] - Saving image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage.ckpt_0000000000000000016 using no compression
2022-05-18 01:47:53,332 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@429] - Saving image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4/current/fsimage.ckpt_0000000000000000016 using no compression
2022-05-18 01:47:53,367 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@432] - Image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-4/current/fsimage.ckpt_0000000000000000016 of size 977 bytes saved in 0 seconds.
2022-05-18 01:47:53,367 - INFO  [FSImageSaver for /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3 of type IMAGE_AND_EDITS:FSImageFormatProtobuf$Saver@432] - Image file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage.ckpt_0000000000000000016 of size 977 bytes saved in 0 seconds.
2022-05-18 01:47:53,406 - INFO  [Standby State Checkpointer:NNStorageRetentionManager@203] - Going to retain 1 images with txid >= 16
2022-05-18 01:47:53,432 - INFO  [TransferFsImageUpload-0:TransferFsImage@435] - Image Transfer timeout configured to 60000 milliseconds
2022-05-18 01:47:53,434 - INFO  [TransferFsImageUpload-0:TransferFsImage@394] - Sending fileName: /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-3/current/fsimage_rollback_0000000000000000016, fileSize: 977. Sent total: 0 bytes. Size of last segment intended to send: 977 bytes.
java.io.IOException: flaky test exception injection of TraceAgent
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at runtime.TraceAgent.createException(TraceAgent.java:127)
	at runtime.LocalInjectionManager.<init>(LocalInjectionManager.java:63)
	at runtime.TraceAgent.main(TraceAgent.java:241)
2022-05-18 01:47:53,437 - ERROR [Standby State Checkpointer:StandbyCheckpointer$CheckpointerThread@451] - Exception in doCheckpoint
java.io.IOException: Exception during image upload: java.io.IOException: flaky test exception injection of TraceAgent
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer.doCheckpoint(StandbyCheckpointer.java:257)
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer.access$1500(StandbyCheckpointer.java:62)
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer$CheckpointerThread.doWork(StandbyCheckpointer.java:432)
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer$CheckpointerThread.access$600(StandbyCheckpointer.java:331)
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer$CheckpointerThread$1.run(StandbyCheckpointer.java:351)
	at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:481)
	at org.apache.hadoop.hdfs.server.namenode.ha.StandbyCheckpointer$CheckpointerThread.run(StandbyCheckpointer.java:347)
Caused by: java.io.IOException: flaky test exception injection of TraceAgent
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at runtime.TraceAgent.createException(TraceAgent.java:127)
	at runtime.LocalInjectionManager.<init>(LocalInjectionManager.java:63)
	at runtime.TraceAgent.main(TraceAgent.java:241)
2022-05-18 01:47:53,437 - INFO  [Standby State Checkpointer:StandbyCheckpointer$CheckpointerThread@402] - Triggering a rollback fsimage for rolling upgrade.
2022-05-18 01:47:53,437 - INFO  [Standby State Checkpointer:StandbyCheckpointer@179] - A checkpoint was triggered but the Standby Node has not received any transactions since the last checkpoint at txid 16. Skipping...
2022-05-18 01:47:53,656 - INFO  [IPC Server handler 5 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:54,658 - INFO  [IPC Server handler 4 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:55,661 - INFO  [IPC Server handler 7 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:56,663 - INFO  [IPC Server handler 8 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:57,665 - INFO  [IPC Server handler 9 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:58,667 - INFO  [IPC Server handler 1 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:47:59,669 - INFO  [IPC Server handler 0 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:48:00,671 - INFO  [IPC Server handler 6 on 10052:NameNodeRpcServer@1302] - rollingUpgrade QUERY
2022-05-18 01:48:01,673 - INFO  [Thread-0:MiniDFSCluster@1957] - Shutting down the Mini HDFS Cluster
2022-05-18 01:48:01,673 - INFO  [Thread-0:MiniDFSCluster@2038] - Shutting down the namenode
2022-05-18 01:48:01,674 - INFO  [Thread-0:FSNamesystem@1301] - Stopping services started for active state
2022-05-18 01:48:01,674 - INFO  [Thread-0:FSEditLog@1369] - Ending log segment 17, 17
2022-05-18 01:48:01,674 - INFO  [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$LazyPersistFileScrubber@3bd3a64e:FSNamesystem$LazyPersistFileScrubber@3985] - LazyPersistFileScrubber was interrupted, exiting
2022-05-18 01:48:01,677 - INFO  [Thread-0:FSEditLog@600] - logSyncAll toSyncToTxId=18 lastSyncedTxid=17 mostRecentTxid=18
2022-05-18 01:48:01,685 - INFO  [Thread-0:FSEditLog@605] - Done logSyncAll lastWrittenTxId=18 lastSyncedTxid=18 mostRecentTxid=18
2022-05-18 01:48:01,685 - INFO  [Thread-0:FSEditLog@770] - Number of transactions: 2 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 0 Number of syncs: 2 SyncTimes(ms): 8 5 2 
2022-05-18 01:48:01,687 - INFO  [IPC Server handler 1 on 41483:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_inprogress_0000000000000000017 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1/current/edits_0000000000000000017-0000000000000000018
2022-05-18 01:48:01,687 - INFO  [IPC Server handler 0 on 39473:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_inprogress_0000000000000000017 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1/current/edits_0000000000000000017-0000000000000000018
2022-05-18 01:48:01,687 - INFO  [IPC Server handler 1 on 44035:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_inprogress_0000000000000000017 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1/current/edits_0000000000000000017-0000000000000000018
2022-05-18 01:48:01,688 - INFO  [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller@3f3bb2b9:FSNamesystem$NameNodeEditLogRoller@3894] - NameNodeEditLogRoller was interrupted, exiting
2022-05-18 01:48:01,688 - INFO  [Thread-0:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000017 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-1/current/edits_0000000000000000017-0000000000000000018
2022-05-18 01:48:01,690 - INFO  [Thread-0:FileJournalManager@143] - Finalizing edits file /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000017 -> /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/name-0-2/current/edits_0000000000000000017-0000000000000000018
2022-05-18 01:48:01,695 - INFO  [CacheReplicationMonitor(1682750226):CacheReplicationMonitor@169] - Shutting down CacheReplicationMonitor
2022-05-18 01:48:01,695 - INFO  [Thread-0:Server@3074] - Stopping server on 10052
2022-05-18 01:48:01,699 - INFO  [IPC Server listener on 10052:Server$Listener@1178] - Stopping IPC Server listener on 10052
2022-05-18 01:48:01,699 - INFO  [RedundancyMonitor:BlockManager$RedundancyMonitor@4415] - Stopping RedundancyMonitor.
2022-05-18 01:48:01,699 - INFO  [StorageInfoMonitor:BlockManager$StorageInfoDefragmenter@4450] - Stopping thread.
2022-05-18 01:48:01,699 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:48:01,756 - INFO  [Thread-0:FSNamesystem@1301] - Stopping services started for active state
2022-05-18 01:48:01,756 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:48:01,758 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@19e3213d{/,null,UNAVAILABLE}{/hdfs}
2022-05-18 01:48:01,759 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@380265ba{HTTP/1.1,[http/1.1]}{localhost:10053}
2022-05-18 01:48:01,759 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@2d2c20fe{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:48:01,785 - INFO  [Thread-0:MiniDFSCluster@2038] - Shutting down the namenode
2022-05-18 01:48:01,785 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:48:01,785 - WARN  [Edit log tailer:EditLogTailer$EditLogTailerThread@447] - Edit log tailer interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.doWork(EditLogTailer.java:445)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.access$400(EditLogTailer.java:380)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread$1.run(EditLogTailer.java:397)
	at org.apache.hadoop.security.SecurityUtil.doAsLoginUserOrFatal(SecurityUtil.java:481)
	at org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer$EditLogTailerThread.run(EditLogTailer.java:393)
2022-05-18 01:48:01,786 - INFO  [Thread-0:Server@3074] - Stopping server on 10054
2022-05-18 01:48:01,790 - INFO  [IPC Server listener on 10054:Server$Listener@1178] - Stopping IPC Server listener on 10054
2022-05-18 01:48:01,790 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:48:01,791 - INFO  [StorageInfoMonitor:BlockManager$StorageInfoDefragmenter@4450] - Stopping thread.
2022-05-18 01:48:01,791 - INFO  [RedundancyMonitor:BlockManager$RedundancyMonitor@4415] - Stopping RedundancyMonitor.
2022-05-18 01:48:01,846 - INFO  [Thread-0:FSNamesystem@1301] - Stopping services started for active state
2022-05-18 01:48:01,846 - INFO  [Thread-0:FSNamesystem@1397] - Stopping services started for standby state
2022-05-18 01:48:01,848 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@74a28385{/,null,UNAVAILABLE}{/hdfs}
2022-05-18 01:48:01,849 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@734320d8{HTTP/1.1,[http/1.1]}{localhost:10055}
2022-05-18 01:48:01,849 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@7bc8998b{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:48:01,871 - INFO  [Thread-0:Server@3074] - Stopping server on 39473
2022-05-18 01:48:01,872 - INFO  [IPC Server listener on 39473:Server$Listener@1178] - Stopping IPC Server listener on 39473
2022-05-18 01:48:01,872 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:48:01,873 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@706fb166{/,null,UNAVAILABLE}{/journal}
2022-05-18 01:48:01,874 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@3812c91a{HTTP/1.1,[http/1.1]}{localhost:0}
2022-05-18 01:48:01,875 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@21a7d37c{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:48:01,875 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/waitactive
2022-05-18 01:48:01,876 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-0/ns1
2022-05-18 01:48:01,876 - INFO  [Thread-0:Server@3074] - Stopping server on 44035
2022-05-18 01:48:01,877 - INFO  [IPC Server listener on 44035:Server$Listener@1178] - Stopping IPC Server listener on 44035
2022-05-18 01:48:01,877 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:48:01,878 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@65508f18{/,null,UNAVAILABLE}{/journal}
2022-05-18 01:48:01,881 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@ab176dd{HTTP/1.1,[http/1.1]}{localhost:0}
2022-05-18 01:48:01,881 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@290f9c56{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:48:02,546 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/waitactive
2022-05-18 01:48:02,546 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-1/ns1
2022-05-18 01:48:02,546 - INFO  [Thread-0:Server@3074] - Stopping server on 41483
2022-05-18 01:48:02,547 - INFO  [IPC Server listener on 41483:Server$Listener@1178] - Stopping IPC Server listener on 41483
2022-05-18 01:48:02,547 - INFO  [IPC Server Responder:Server$Responder@1312] - Stopping IPC Server Responder
2022-05-18 01:48:02,548 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.w.WebAppContext@23b06aa7{/,null,UNAVAILABLE}{/journal}
2022-05-18 01:48:02,549 - INFO  [Thread-0:AbstractConnector@318] - Stopped ServerConnector@45badd20{HTTP/1.1,[http/1.1]}{localhost:0}
2022-05-18 01:48:02,550 - INFO  [Thread-0:ContextHandler@910] - Stopped o.e.j.s.ServletContextHandler@30ee8c83{/static,jar:file:/home/haoze/flaky-reproduction/systems/hdfs-12248/hadoop-tools/hadoop-distcp/target/lib/hadoop-hdfs-3.0.0-beta1-SNAPSHOT-tests.jar!/webapps/static,UNAVAILABLE}
2022-05-18 01:48:02,550 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/waitactive
2022-05-18 01:48:02,550 - INFO  [Thread-0:JNStorage@281] - Closing journal storage for Storage Directory /home/haoze/flaky-reproduction/experiment/hdfs-12248/target/test/data/dfs/journalnode-2/ns1
2022-05-18 01:48:02,551 - INFO  [Thread-0:MetricsSystemImpl@210] - Stopping NameNode metrics system...
2022-05-18 01:48:02,553 - INFO  [Thread-0:MetricsSystemImpl@216] - NameNode metrics system stopped.
2022-05-18 01:48:02,553 - INFO  [Thread-0:MetricsSystemImpl@607] - NameNode metrics system shutdown complete.
E
Time: 20.528
There was 1 failure:
1) testRollBackImage(org.apache.hadoop.hdfs.TestRollingUpgrade)
java.lang.AssertionError: Query return false
	at org.junit.Assert.fail(Assert.java:88)
	at org.apache.hadoop.hdfs.TestRollingUpgrade.queryForPreparation(TestRollingUpgrade.java:155)
	at org.apache.hadoop.hdfs.TestRollingUpgrade.testRollBackImage(TestRollingUpgrade.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)

FAILURES!!!
Tests run: 1,  Failures: 1

